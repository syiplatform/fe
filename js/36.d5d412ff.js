(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[36],{1554:function(e,t,r){"use strict";var n=r("9fe5"),s=r.n(n);s.a},"9fe5":function(e,t,r){},ef79:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("q-card",{staticClass:"border-radius q-mb-md bg-white"},[r("div",{staticClass:"row q-pa-md q-mb-xs"},[r("q-input",{staticClass:"col q-mr-lg",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",debounce:300,placeholder:e.$t("contest_list_search_placeholder"),color:"secondary",icon:"search"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),r("div",{staticClass:"col-xs-auto"},[r("add-button",{attrs:{namespace:"contest",showFormMutationName:"contestShowForm",setSelectedIdMutationName:"contestSetSelectedId"}})],1)],1)]),r("div",{class:e.$q.screen.lt.sm?"q-py-sm":""},[r("image-tiles",{ref:"imageTiles",attrs:{namespace:"contest",pagedListName:"contest",hasInfo:!0,hasMain:!1,deleteRecordActionName:"deleteContest",showFormMutationName:"contestShowForm",deleteErrorGetterName:"contestDeleteError",confirmErrorGetterName:"contestConfirmError",confirmErrorActionName:"contestConfirmError",setSelectedIdMutationName:"contestSetSelectedId",fetch:e.fetch,messageConfirmDialogConfirmation:"contest_confirm_dialog_confirmation",messageFormErrorsCanNotDelete:"contest_form_errors_can_not_delete",messageFormSuccessDelete:"contest_form_success_deleted"},scopedSlots:e._u([{key:"title",fn:function(t){var n=t.entity;return[r("span",[e._v(e._s(n.name))])]}},{key:"info",fn:function(t){var n=t.entity;return[r("div",{staticClass:"row"},[r("div",{staticClass:"q-pr-sm"},[r("div",[e._v("\n                "+e._s(e._f("dateTimeText")(n.startDate))+" - "+e._s(e._f("dateTimeText")(n.endDate))+"\n              ")]),r("div",[e._v(e._s(e.$t("contest_data_source_"+n.dataSource)))])])])]}}])}),r("contest-form")],1)],1)},s=[],a=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("96cf"),r("c973")),o=r.n(a),i=r("9523"),c=r.n(i),l=r("11ec"),d=r("2f62"),u=r("ee47"),m=r("241b"),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-dialog",{attrs:{value:e.contestFormIsVisible,maximized:e.$q.screen.lt.sm},on:{"before-hide":e.cancel}},[r("q-layout",{staticClass:"bg-white",attrs:{view:"hhh lpr fFf",container:""}},[r("q-page-container",[e.contestFormIsVisible?r("q-page",{staticClass:"bg-white q-py-md",class:e.$q.screen.lt.sm?"q-px-md":"q-px-lg "},[r("div",{staticClass:"text-h5"},[e._v("\n                "+e._s(e.isCreation?e.$t("contest_create_page_title"):e.formModel.name)+"\n        ")]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 row"},[r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_name"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.name.$error,"error-message":e.getErrorMessage(e.$v.formModel.name,e.t)},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name","string"===typeof t?t.trim():t)},expression:"formModel.name"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",type:"number",label:e.$t("field_contest_number_of_winners"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.numberOfWinners.$error,"error-message":e.getErrorMessage(e.$v.formModel.numberOfWinners,e.t)},model:{value:e.formModel.numberOfWinners,callback:function(t){e.$set(e.formModel,"numberOfWinners",e._n(t))},expression:"formModel.numberOfWinners"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-checkbox",{attrs:{label:e.$t("field_contest_is_public")},model:{value:e.formModel.isPublic,callback:function(t){e.$set(e.formModel,"isPublic",t)},expression:"formModel.isPublic"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-checkbox",{attrs:{label:e.$t("field_contest_is_one_per_user")},model:{value:e.formModel.isOnePerUser,callback:function(t){e.$set(e.formModel,"isOnePerUser",t)},expression:"formModel.isOnePerUser"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-checkbox",{attrs:{label:e.$t("field_contest_need_voting")},model:{value:e.formModel.needVoting,callback:function(t){e.$set(e.formModel,"needVoting",t)},expression:"formModel.needVoting"}})],1),r("q-field",{staticClass:"col-xs-12 q-px-xs q-mb-sm",attrs:{borderless:"","stack-label":"",label:e.$t("field_description"),color:"dark"}},[r("custom-editor",{staticClass:"col-xs-12",attrs:{model:e.formModel.description,onChange:function(t){return e.formModel.description=t}}})],1),r("div",{staticClass:"col-xs-6 q-pr-xs"},[r("q-input",{attrs:{label:e.$t("field_contest_start_date"),rounded:"",standout:"bg-grey-2 text-grey-14","bottom-slots":"",error:e.$v.formModel.startDate.$error,"error-message":e.getErrorMessage(e.$v.formModel.startDate,e.t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[r("q-popup-proxy",{ref:"startDate",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-date",{attrs:{mask:e.dateTimeTemplate},on:{input:function(){return e.$refs.startDate.hide()}},model:{value:e.formStartDate,callback:function(t){e.formStartDate=t},expression:"formStartDate"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[r("q-popup-proxy",{ref:"endRequestTime",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-time",{attrs:{mask:e.dateTimeTemplate,format24h:""},on:{input:function(){return e.$refs.endRequestTime.hide()}},model:{value:e.formStartDate,callback:function(t){e.formStartDate=t},expression:"formStartDate"}})],1)],1)]},proxy:!0}],null,!1,3512681191),model:{value:e.formStartDate,callback:function(t){e.formStartDate=t},expression:"formStartDate"}})],1),r("div",{staticClass:"col-xs-6 q-pr-xs"},[r("q-input",{attrs:{label:e.$t("field_contest_end_date"),rounded:"",standout:"bg-grey-2 text-grey-14","bottom-slots":"",error:e.$v.formModel.endDate.$error,"error-message":e.getErrorMessage(e.$v.formModel.endDate,e.t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[r("q-popup-proxy",{ref:"endDate",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-date",{attrs:{mask:e.dateTimeTemplate},on:{input:function(){return e.$refs.endDate.hide()}},model:{value:e.formEndDate,callback:function(t){e.formEndDate=t},expression:"formEndDate"}})],1)],1)]},proxy:!0},{key:"append",fn:function(){return[r("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[r("q-popup-proxy",{ref:"endRequestTime",attrs:{"transition-show":"scale","transition-hide":"scale"}},[r("q-time",{attrs:{mask:e.dateTimeTemplate,format24h:""},on:{input:function(){return e.$refs.endRequestTime.hide()}},model:{value:e.formEndDate,callback:function(t){e.formEndDate=t},expression:"formEndDate"}})],1)],1)]},proxy:!0}],null,!1,1004517991),model:{value:e.formEndDate,callback:function(t){e.formEndDate=t},expression:"formEndDate"}})],1),r("div",{staticClass:"row col-xs-12 col-sm-6 relative-position q-px-xs screenshot"},[e.formModel.imagePath?e._e():r("q-file",{staticClass:"col-xs-12",attrs:{filled:"","input-style":{height:"200px"},value:e.uploaded,label:e.$t("field_contest_image_path_helper"),error:e.$v.formModel.imagePath.$error,"error-message":e.getErrorMessage(e.$v.formModel.imagePath,e.t)},on:{input:e.upload},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{staticClass:"q-mt-md",attrs:{name:"attach_file"}})]},proxy:!0}],null,!1,4244582943)}),e.formModel.imagePath?r("q-img",{staticClass:"col-xs-12",attrs:{height:"200px",src:""+e.urls.imagePath+e.formModel.imagePath}}):e._e(),e.formModel.imagePath?r("div",{staticClass:"absolute-top-right row column remove-btn"},[r("q-btn",{staticClass:"q-mt-md q-mr-md",attrs:{round:"",color:"negative",icon:"clear"},on:{click:function(t){return e.removeUploadedImage()}}})],1):e._e()],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-select",{attrs:{label:e.$t("field_contest_data_source"),hint:e.$t("field_price_unit_hint"),options:e.dataSourceOptions,"emit-value":"","map-options":"","bottom-slots":""},model:{value:e.formModel.dataSource,callback:function(t){e.$set(e.formModel,"dataSource",t)},expression:"formModel.dataSource"}})],1)],1)])]):e._e()],1),r("q-footer",{staticClass:"bg-white row q-py-sm q-px-md"},[r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"order-last":"q-mr-sm",attrs:{rounded:"",label:e.$t("action_cancel"),color:"secondary",disable:e.loading,icon:"arrow_back"},on:{click:e.cancel}}),r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"q-mb-sm":"q-mr-sm",attrs:{rounded:"",label:e.$t(e.isCreation?"action_create":"action_save"),color:"primary",icon:e.isCreation?"add":"save",loading:e.loading},on:{click:e.saveChanges}})],1)],1)],1)},p=[],h=(r("7f7f"),r("d47e")),g=r("1cb6"),b=r("b5ae"),v=r("5944"),_=r("d59f"),x=r("376c"),q=r("aacf"),y=r("4147");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var C={name:"ContestForm",mixins:[v["a"]],components:{CustomEditor:x["a"]},data:function(){var e=this,t=y["b"].map((function(t){return{label:e.$t(t.label),value:t.value}}));return{t:this.$t.bind(this),formModelKey:"contestDetails",loading:!1,uploaded:null,dateTimeTemplate:h["d"],urls:q["a"],dataSourceOptions:t}},computed:$({},Object(d["c"])("auth",["currentUserTimezone"]),{},Object(d["c"])("contest",["contestCreateError","contestUpdateError","contestDetails","contestId","contestFormIsVisible"]),{isCreation:function(){return!this.contestId},formStartDate:{get:function(){return Object(h["l"])(this.formModel.startDate)},set:function(e){this.formModel.startDate=Object(h["i"])(e,this.currentUserTimezone)}},formEndDate:{get:function(){return Object(h["l"])(this.formModel.endDate)},set:function(e){this.formModel.endDate=Object(h["i"])(e,this.currentUserTimezone)}}}),watch:{contestFormIsVisible:function(){var e=o()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.fetchContestDetails({variables:{id:+this.contestId}});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},methods:$({},Object(d["d"])("contest",["contestHideForm"]),{},Object(d["b"])("contest",["fetchContestDetails","createContest","updateContest"]),{},Object(d["b"])("image",["uploadImage"]),{getErrorMessage:_["a"],upload:function(){var e=o()(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.uploadImage({file:t,type:"image"});case 3:r=e.sent,r.file&&(this.uploaded=t,this.formModel.imagePath=r.file.name),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),this.$q.notify({type:"negative",message:e.t0});case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t){return e.apply(this,arguments)}return t}(),removeUploadedImage:function(){this.uploaded=null,this.formModel.imagePath=null},createNewContest:function(){var e=o()(regeneratorRuntime.mark((function e(){var t,r,n,s,a,o,i,c,l,d,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.name,n=t.description,s=t.startDate,a=t.endDate,o=t.dataSource,i=t.numberOfWinners,c=t.isPublic,l=t.isOnePerUser,d=t.needVoting,u=t.imagePath,e.prev=1,e.next=4,this.createContest({variables:{name:r,description:n,startDate:s,endDate:a,dataSource:o,numberOfWinners:i,isPublic:c,isOnePerUser:l,needVoting:d,imagePath:u}});case 4:this.contestCreateError?this.$q.notify({type:"negative",message:this.contestCreateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("contest_form_success_created")}),g["a"].logEvent("contests-page","create-contest",0,0,this.$router.currentRoute)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("contest_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),editContest:function(){var e=o()(regeneratorRuntime.mark((function e(){var t,r,n,s,a,o,i,c,l,d,u,m;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.id,n=t.name,s=t.description,a=t.startDate,o=t.endDate,i=t.dataSource,c=t.numberOfWinners,l=t.isPublic,d=t.isOnePerUser,u=t.needVoting,m=t.imagePath,e.prev=1,e.next=4,this.updateContest({variables:{id:r,name:n,description:s,startDate:a,endDate:o,dataSource:i,numberOfWinners:c,isPublic:l,isOnePerUser:d,needVoting:u,imagePath:m}});case 4:this.contestUpdateError?this.$q.notify({type:"negative",message:this.contestUpdateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("contest_form_success_updated")}),g["a"].logEvent("contest-page","edit-contest",0,0,this.$router.currentRoute)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("contest_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),saveChanges:function(){var e=o()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.validateFormAndNotify()){e.next=2;break}return e.abrupt("return");case 2:if(this.loading=!0,!this.isCreation){e.next=8;break}return e.next=6,this.createNewContest();case 6:e.next=10;break;case 8:return e.next=10,this.editContest();case 10:this.loading=!1;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$v.$reset(),this.contestHideForm()}}),validations:{formModel:{name:{required:b["required"],maxLength:Object(b["maxLength"])(200)},startDate:{required:b["required"]},endDate:{required:b["required"]},numberOfWinners:{required:b["required"]},imagePath:{required:b["required"]}}}},w=C,D=(r("1554"),r("42e1")),M=Object(D["a"])(w,f,p,!1,null,"55002552",null),P=M.exports,k=r("b22d");function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={name:"Contests",mixins:[u["a"]],components:{ImageTiles:m["a"],ContestForm:P,AddButton:k["a"]},data:function(){return{searchTerm:"",urls:q["a"]}},meta:function(){return{title:this.$t("company_contests_admin_page_title")}},computed:S({},Object(d["c"])("contest",{pagination:"contestPagedListPagination"})),destroyed:function(){this.resetPagination()},watch:{searchTerm:function(){this.resetPagination();var e=!1;this.fetch(e),g["a"].logEvent("contest-page","search-contest",this.searchTerm,0,this.$router.currentRoute)}},methods:S({},Object(d["b"])("contest",["fetchContestPagedList"]),{},Object(d["d"])("contest",{paginationUpdate:"contestPagedListPaginationUpdate"}),{resetPagination:function(){var e=Object(l["a"])(!0,{},this.pagination);e.pageNumber=1,this.paginationUpdate(e)},fetch:function(){var e=o()(regeneratorRuntime.mark((function e(){var t,r,n,s,a,o,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]&&i[0],t||this.$refs.imageTiles&&this.$refs.imageTiles.reset(),r=this.pagination,n=r.pageNumber,s=r.pageSize,a=r.sortBy,o=r.descending,e.next=5,this.fetchContestPagedList({variables:{searchTerm:this.searchTerm,pageNumber:n,pageSize:s,sortBy:a,descending:o},needAppendItems:t});case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()})},T=j,R=Object(D["a"])(T,n,s,!1,null,null,null);t["default"]=R.exports}}]);