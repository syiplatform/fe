(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{2699:function(e,t,r){"use strict";var n=r("3e2d"),i=r.n(n);i.a},"3e2d":function(e,t,r){},e1b5:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{staticClass:"row q-my-sm",on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[r("div",{staticClass:"col-xs-12 q-px-xs"},[r("div",[r("img",{attrs:{alt:e.$t("img_logo_alt"),title:e.$t("img_logo_title"),src:"statics/logo.svg"}})]),r("h1",{staticClass:"text-h6 text-center"},[e._v("\n      "+e._s(e.$t("signup_h1_text"))+"\n    ")])]),r("div",{staticClass:"row col-xs-12 q-px-sm justify-center text-center q-mb-sm text-grey-7"},[e.authSignupUser?r("div",{staticClass:"col-xs-auto"},[e._v("\n      "+e._s(e.$t("signup_last_step_for_sso"))+"\n    ")]):r("div",{staticClass:"col-xs-auto"},[e._v("\n      "+e._s(e.$t("signup_title"))+"\n    ")])]),r("div",{staticClass:"col-xs-12 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_username")+"*",hint:e.$t("signup_company_username_hint"),maxlength:"50","bottom-slots":"",debounce:"500",error:e.$v.form.companyPath.$error,"error-message":e.getErrorMessage(e.$v.form.companyPath,e.t),autofocus:""},scopedSlots:e._u([e.$v.form.companyPath.$invalid?null:{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}],null,!0),model:{value:e.commonField,callback:function(t){e.commonField="string"===typeof t?t.trim():t},expression:"commonField"}})],1),r("q-expansion-item",{staticClass:"col-xs-12",attrs:{dense:"","dense-toggle":"","expand-separator":"","header-class":"text-right text-overline",label:e.$t("signup_advanced_settings")}},[r("div",{staticClass:"col-xs-12 row bg-grey-2 q-px-sm"},[r("div",{staticClass:"col-xs-12 text-weight-light text-left"},[r("div",{staticClass:"text-grey q-py-sm"},[e._v("\n          "+e._s(e.$t("signup_company_company_path"))+"\n        ")]),r("div",{staticClass:"text-secondary"},[e._v("\n          "+e._s("https://seeyour.info/"+(e.form.companyPath||"..."))+"\n        ")])]),r("div",{staticClass:"col-xs-12"},[r("q-input",{attrs:{label:e.$t("field_company_path")+"*",hint:e.$t("signup_company_company_path_hint"),maxlength:"50","bottom-slots":"",debounce:"500",error:e.$v.form.companyPath.$error,"error-message":e.getErrorMessage(e.$v.form.companyPath,e.t)},scopedSlots:e._u([e.$v.form.companyPath.$invalid?null:{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}],null,!0),model:{value:e.form.companyPath,callback:function(t){e.$set(e.form,"companyPath","string"===typeof t?t.trim():t)},expression:"form.companyPath"}})],1),r("div",{staticClass:"col-xs-12"},[r("q-input",{attrs:{label:e.$t("field_name")+"*",hint:e.$t("field_name_hint"),maxlength:"255","bottom-slots":"",debounce:"500",error:e.$v.form.companyName.$error,"error-message":e.getErrorMessage(e.$v.form.companyName,e.t)},scopedSlots:e._u([e.$v.form.companyName.$invalid?null:{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}],null,!0),model:{value:e.form.companyName,callback:function(t){e.$set(e.form,"companyName","string"===typeof t?t.trim():t)},expression:"form.companyName"}})],1),r("div",{staticClass:"col-xs-12"},[r("q-select",{attrs:{label:e.$t("field_timezone")+"*","emit-value":"","map-options":"","bottom-slots":"","use-input":"","use-chips":"",debounce:"500",options:e.filteredTimezoneOptions,error:e.$v.form.timezone.$error,"error-message":e.getErrorMessage(e.$v.form.timezone,e.t)},on:{filter:e.filterTimezones},model:{value:e.form.timezone,callback:function(t){e.$set(e.form,"timezone","string"===typeof t?t.trim():t)},expression:"form.timezone"}}),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.form.timezone,expression:"!form.timezone"}],staticClass:"timezone-suggestion q-ma-sm"},[e._v("\n          "+e._s(e.$t("timezone_suggestion"))+"\n          "),r("span",{staticClass:"timezone-name"},[e._v(e._s(e.suggestedTimezoneText))]),e._v("\n          "+e._s("?")+"\n          "),r("q-btn",{attrs:{rounded:""},on:{click:e.setupSuggestedTimezone}},[e._v("\n            "+e._s(e.$t("timezone_suggestion_set_up"))+"\n          ")])],1)],1)])]),e.authSignupUser?e._e():r("div",{staticClass:"col-xs-12 col-sm-6 q-px-xs"},[r("q-input",{attrs:{type:"password",label:e.$t("field_password")+"*",maxlength:"255","bottom-slots":"",debounce:"500","lazy-rules":!0,error:e.$v.form.adminPassword.$error,"error-message":e.getErrorMessage(e.$v.form.adminPassword,e.t)},scopedSlots:e._u([e.$v.form.adminPassword.$invalid?null:{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}],null,!0),model:{value:e.form.adminPassword,callback:function(t){e.$set(e.form,"adminPassword","string"===typeof t?t.trim():t)},expression:"form.adminPassword"}})],1),e.authSignupUser?e._e():r("div",{staticClass:"col-xs-12 col-sm-6 q-px-xs"},[r("q-input",{attrs:{type:"password",label:e.$t("field_repeat_password")+"*",maxlength:"255","bottom-slots":"",debounce:"500",error:e.$v.form.repeatPassword.$error,"error-message":e.getErrorMessage(e.$v.form.repeatPassword,e.t)},scopedSlots:e._u([e.$v.form.repeatPassword.$invalid?null:{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}],null,!0),model:{value:e.form.repeatPassword,callback:function(t){e.$set(e.form,"repeatPassword","string"===typeof t?t.trim():t)},expression:"form.repeatPassword"}})],1),r("transition",{attrs:{appear:"","appear-active-class":"animated fadeInRight"}},[e.emailError?r("q-banner",{staticClass:"col-xs-12 bg-red text-white border-radius text-left",scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{staticClass:"q-mr-sm",attrs:{name:"warning",color:"white"}})]},proxy:!0}],null,!1,2055677619)},[e._v("\n      "+e._s(e.$t("signup_company_email_error"))+"\n      "),r("a",{staticClass:"text-warning q-px-sm",attrs:{target:"_blank",title:e.$t("need_help_title"),href:e.urls.blog.resetPassword}},[e._v("\n        "+e._s(e.$t("need_help_signup_email_error"))+"\n      ")])]):e._e()],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_email")+"*",maxlength:"255","bottom-slots":"",debounce:"500",readonly:e.isEmailConfirmed,error:!!e.emailError||e.$v.form.email.$error,"error-message":e.emailError||e.getErrorMessage(e.$v.form.email,e.t)},on:{input:function(){return e.emailError=""}},scopedSlots:e._u([!e.$v.form.email.$invalid&&e.isEmailConfirmed?{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}:null],null,!0),model:{value:e.form.email,callback:function(t){e.$set(e.form,"email","string"===typeof t?t.trim():t)},expression:"form.email"}})],1),r("div",{staticClass:"col-xs-12 col-sm q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_email_confirmation_code")+"*",maxlength:"6","bottom-slots":"",debounce:"500",readonly:e.isEmailConfirmed,error:e.$v.form.emailVerificationCode.$error,rules:[e.confirmEmail]},scopedSlots:e._u([!e.$v.form.emailVerificationCode.$invalid&&e.isEmailConfirmed?{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}:null,{key:"error",fn:function(){return[e._v("\n        "+e._s(e.getErrorMessage(e.$v.form.emailVerificationCode,e.t))+"\n        "),r("div",{staticClass:"q-pt-xs"},[r("a",{staticClass:"text-info",attrs:{target:"_blank",title:e.$t("need_help_signup_email_code_title"),href:e.urls.blog.signupEmailCode}},[e._v("\n            "+e._s(e.$t("need_help_signup_email_code"))+"\n          ")])])]},proxy:!0},{key:"hint",fn:function(){return[e._v("\n        "+e._s(e.codeWasSendedCounter?e.$t("field_email_confirmation_code_hint"):"")+"\n        "),r("div",{staticClass:"q-pt-xs"},[r("a",{staticClass:"text-info",attrs:{target:"_blank",title:e.$t("need_help_signup_email_code_title"),href:e.urls.blog.signupEmailCode}},[e._v("\n            "+e._s(e.$t("need_help_signup_email_code"))+"\n          ")])])]},proxy:!0}],null,!0),model:{value:e.form.emailVerificationCode,callback:function(t){e.$set(e.form,"emailVerificationCode","string"===typeof t?t.trim():t)},expression:"form.emailVerificationCode"}})],1),r("transition",{attrs:{appear:"","leave-active-class":"animated fadeOutRight"}},[e.isEmailConfirmed?e._e():r("div",{staticClass:"col-xs-12 col-sm-3 row q-px-xs q-pt-sm q-pb-lg items-stretch",class:{"q-pb-xl":!e.$q.screen.lt.sm&&e.codeWasSendedCounter}},[r("q-btn",{staticClass:"col-xs-12 q-py-sm",attrs:{rounded:"",disable:e.isCodeSending||!!e.timerId||e.$v.form.email.$invalid,loading:e.isCodeSending,color:"primary"},on:{click:e.sendCode}},[[e.timerId?r("div",{staticClass:"q-py-xs"},[e._v("\n            "+e._s(e.time)+"\n          ")]):r("div",{staticClass:"text-caption"},[e._v("\n            "+e._s(e.codeWasSendedCounter>0?e.$t("send_email_confirmation_code_again"):e.$t("send_email_confirmation_code"))+"\n          ")])]],2)],1)]),r("div",{staticClass:"col-xs-12 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_referral_code"),maxlength:"20","bottom-slots":"",debounce:"500",hint:e.$t("field_referral_code_hint"),error:e.$v.form.referralCode.$error,"error-message":e.getErrorMessage(e.$v.form.referralCode,e.t),rules:[e.confirmEmail]},scopedSlots:e._u([e.form.referralCode&&!e.$v.form.referralCode.$invalid?{key:"append",fn:function(){return[r("q-icon",{attrs:{name:"done",color:"green"}})]},proxy:!0}:null],null,!0),model:{value:e.form.referralCode,callback:function(t){e.$set(e.form,"referralCode","string"===typeof t?t.trim():t)},expression:"form.referralCode"}})],1),r("q-field",{staticClass:"col-xs-12 q-px-xs",class:{"q-pt-md q-mt-sm":!e.$q.screen.lt.sm&&!e.codeWasSendedCounter,"q-pt-sm":e.$q.screen.lt.sm},attrs:{borderless:"","no-error-icon":"",error:e.$v.form.agreeWithTerms.$error},scopedSlots:e._u([{key:"before",fn:function(){return[r("q-checkbox",{model:{value:e.form.agreeWithTerms,callback:function(t){e.$set(e.form,"agreeWithTerms",t)},expression:"form.agreeWithTerms"}})]},proxy:!0}])},[[r("span",{staticClass:"text-caption"},[e._v("\n        "+e._s(e.$t("signup_agree_with"))+"\n        "),r("span",{staticClass:"cursor-pointer",on:{click:function(t){return e.openURL("https://seeyour.info/privacy-policy-"+e.$q.lang.isoName)}}},[e._v("\n          "+e._s(e.$t("signup_agree_with_policy"))+"\n        ")]),r("span",[e._v(e._s(e.$t("And")))]),r("span",{staticClass:"cursor-pointer",on:{click:function(t){return e.openURL("https://seeyour.info/about-terms-"+e.$q.lang.isoName)}}},[e._v("\n          "+e._s(e.$t("signup_agree_with_terms"))+"\n        ")])])]],2),r("div",{staticClass:"col-xs-12 row q-mt-lg"},[r("q-btn",{staticClass:"col-xs-12 q-py-sm signup-company-btn-signup",attrs:{rounded:"",type:"submit",label:e.$t("signup_company_register_action"),color:"secondary"}}),r("q-btn",{staticClass:"col-xs-12 q-mt-md q-py-sm signup-company-btn-back-to-login",attrs:{rounded:"",to:{name:"login-"+e.$q.lang.isoName},label:e.$t("action_back_to_login"),title:e.$t("action_back_to_login_title"),"text-color":"secondary"},on:{click:function(t){return e.logClickEvent("back-action")}}})],1),r("div",{staticClass:"row justify-between q-pt-md col-xs-12"},[r("language-selector",{staticClass:"col-xs-auto",attrs:{color:"grey-14"}})],1)],1)},i=[],o=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("448a")),a=r.n(o),s=(r("96cf"),r("c973")),c=r.n(s),l=r("9523"),m=r.n(l),u=r("4dd0"),d=r.n(u),p=r("b06b"),f=r("1cb6"),g=r("2f62"),h=r("b5ae"),_=r("d59f"),y=r("e8f4"),v=r("c81d"),b=r("96fb"),x=r("aacf"),$=r("741e"),C=r("49ac"),q=r("70ec");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E={name:"Signup",mixins:[y["a"],v["a"]],components:{LanguageSelector:q["a"]},props:{referral:String,canonicUrl:{type:String,required:!1}},meta:function(){var e;return e=this.canonicUrl?"".concat("https://seeyour.local:8080").concat(this.canonicUrl):this.$router.currentRoute.path,{title:this.pageTitle,meta:{description:{name:"description",content:this.pageDescription},"og:title":{property:"og:title",content:this.pageTitle},"og:description":{property:"og:description",content:this.pageDescription},"og:url":{property:"og:url",content:e}},link:{canonical:{rel:"canonical",href:e},alternateRu:{rel:"alternate",hreflang:"ru",href:"".concat("https://seeyour.local:8080","/signup-company")},alternateEn:{rel:"alternate",hreflang:"en",href:"".concat("https://seeyour.local:8080","/en/signup-company")}}}},data:function(){return{pageTitle:this.$t("signup_page_title"),pageDescription:this.$t("signup_page_description"),t:this.$t.bind(this),urls:x["a"],form:{companyName:"",companyPath:"",email:"",emailVerificationCode:null,timezone:"",adminUsername:"",adminPassword:"",referralCode:this.$q.cookies.has("syi-referral_code")?this.$q.cookies.get("syi-referral_code"):"",agreeWithTerms:!1},isCodeSending:!1,emailError:"",commonField:"",timerId:null,time:0,codeWasSendedCounter:0}},computed:w({},Object(g["c"])("auth",["companySignupError","companySignupErrorMessage","authSignupUser","emailVerificationCodeSendingError","isEmailConfirmed"]),{},Object(g["c"])("landingConfiguration",["landingConfigurationDetails","productList","landingConfigurationUpdateErrorCode"]),{},Object(g["c"])("product",["productCreateBulkData"])),watch:{commonField:function(e,t){this.form.adminUsername=this.authSignupUser?"":e,this.form.companyPath=this.form.companyPath===t?e:this.form.companyPath,this.form.companyName=this.form.companyName===t?e:this.form.companyName}},methods:w({},Object(g["b"])("auth",["signupIndividualCompany","sendEmailVerificationCode","checkEmailVerificationCode"]),{},Object(g["d"])("auth",["resetEmailConfirmation"]),{},Object(g["b"])("landingConfiguration",["updateLandingConfiguration"]),{},Object(g["b"])("product",["createBulkProducts"]),{openURL:p["a"],getErrorMessage:_["a"],setupSuggestedTimezone:function(){this.form.timezone=this.suggestedTimezone},logClickEvent:function(e){f["a"].logEvent("signup-company-page","click",e,0,this.$router.currentRoute)},handleSubmit:function(){var e=c()(regeneratorRuntime.mark((function e(){var t,r,n,i,o,s,c=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.form.$touch(),!this.$v.form.$error){e.next=3;break}return e.abrupt("return");case 3:return t={companyName:this.form.companyName,companyPath:this.form.companyPath,activityType:this.form.activityType,email:this.form.email,emailVerificationCode:this.form.emailVerificationCode,adminUsername:this.form.adminUsername,adminPassword:this.form.adminPassword,timezone:this.form.timezone,test:1,referralCode:this.form.referralCode,lang:this.$i18n.locale},this.authSignupUser&&(t.serviceType=this.authSignupUser.serviceType,t.serviceId=this.authSignupUser.serviceId),this.$q.loading.show(),e.prev=6,e.next=9,this.signupIndividualCompany({variables:t});case 9:if(!this.companySignupErrorMessage){e.next=13;break}this.$q.notify({type:"negative",message:this.$t(this.companySignupErrorMessage)}),e.next=32;break;case 13:if(f["a"].logEvent("signup-company-page","click","signup-action",0,this.$router.currentRoute),this.$q.cookies.has("syi-referral_code")&&this.$q.cookies.remove("syi-referral_code"),this.$q.notify({type:"positive",message:this.$t("signup_company_register_success")}),r=d.a.get("currentUser"),n=d.a.get("signup-landing-configuration"),i=d.a.get("signup-product-list"),!(n&&r.companyRoles&&r.companyRoles.length)){e.next=31;break}if(o=r.companyRoles[0].companyId,!i){e.next=26;break}return e.next=24,this.createBulkProducts({products:this.productList,companyId:+o});case 24:s=Object($["c"])(n,C["a"].customElementCatalogProducts),s&&s[0]&&s[0].options&&s[0].options.userData&&(s[0].options.userData.products=a()(this.productCreateBulkData));case 26:return n.id=0,e.next=29,this.updateLandingConfiguration({id:n.id,landingConfiguration:n,companyId:o,$t:this.$t.bind(this)});case 29:f["a"].logEvent("signup-company-page","click","signup-with-template-action",0,this.$router.currentRoute),this.landingConfigurationUpdateErrorCode&&this.$q.notify({type:"negative",message:this.$t(this.landingConfigurationUpdateErrorCode)});case 31:setTimeout((function(){c.redirectBasedOnPermissions()}),1e3);case 32:e.next=37;break;case 34:e.prev=34,e.t0=e["catch"](6),this.$q.notify({type:"negative",message:this.$t("signup_company_register_error")});case 37:this.$q.loading.hide();case 38:case"end":return e.stop()}}),e,this,[[6,34]])})));function t(){return e.apply(this,arguments)}return t}(),sendCode:function(){var e=c()(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.$v.form.email.$invalid){e.next=6;break}return this.isCodeSending=!0,e.next=4,this.sendEmailVerificationCode({variables:{email:this.form.email}});case 4:this.emailVerificationCodeSendingError?this.emailError=this.emailVerificationCodeSendingError:(this.emailError="",this.codeWasSendedCounter=this.codeWasSendedCounter+1,this.time=90,this.timerId=setInterval((function(){t.time=t.time-1,t.timerId&&0===t.time&&(clearInterval(t.timerId),t.timerId=null)}),1e3)),this.isCodeSending=!1;case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),confirmEmail:function(){var e=c()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t||6!==t.length){e.next=6;break}if(!this.form.email){e.next=5;break}return e.next=4,this.checkEmailVerificationCode({variables:{email:this.form.email,emailVerificationCode:t}});case 4:return e.abrupt("return",!!this.isEmailConfirmed);case 5:return e.abrupt("return",this.$t("confirm_email_empty"));case 6:return e.abrupt("return",!0);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),beforeDestroy:function(){this.timerId&&clearInterval(this.timerId)},mounted:function(){this.isAuthenticated&&this.$router.push({name:"client-profile"}),this.authSignupUser&&(this.form.email=this.authSignupUser.email),this.resetEmailConfirmation(),this.setupSuggestedTimezone()},validations:function(){var e={form:{companyName:{required:h["required"],maxLength:Object(h["maxLength"])(255)},companyPath:{required:h["required"],minLength:Object(h["minLength"])(3),maxLength:Object(h["maxLength"])(50),urlPath:b["a"]},email:{email:h["email"],required:h["required"],maxLength:Object(h["maxLength"])(255)},emailVerificationCode:{numeric:h["numeric"],required:h["required"],maxLength:Object(h["maxLength"])(6),minLength:Object(h["minLength"])(6)},timezone:{required:h["required"]},referralCode:{maxLength:Object(h["maxLength"])(20),minLength:Object(h["minLength"])(20)},agreeWithTerms:{required:h["required"],sameAs:Object(h["sameAs"])((function(){return!0}))}}};return this.authSignupUser||(e.form.adminPassword={required:h["required"],minLength:Object(h["minLength"])(6),maxLength:Object(h["maxLength"])(80)},e.form.repeatPassword={sameAsPassword:Object(h["sameAs"])("adminPassword")}),e}},S=E,P=(r("2699"),r("42e1")),O=Object(P["a"])(S,n,i,!1,null,"0f8c3dd2",null);t["default"]=O.exports}}]);