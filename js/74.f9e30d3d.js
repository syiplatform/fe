(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[74],{c2c1:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"bg-white"},[r("div",{staticClass:"q-pa-sm"},[r("div",{staticClass:"text-h5"},[e._v("\n        "+e._s(e.$t("project_invoice_list_title"))+"\n      ")]),r("div",{staticClass:"row q-pb-md q-mb-xs justify-between"},[r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-input",{staticClass:"q-mx-md",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",debounce:"500",placeholder:e.$t("project_invoice_list_filter_name")},model:{value:e.namePhoneSearchTerm,callback:function(t){e.namePhoneSearchTerm=t},expression:"namePhoneSearchTerm"}})],1),r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-input",{staticClass:"q-mx-md",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",debounce:"500",placeholder:e.$t("project_invoice_list_filter_company")},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}})],1),r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-select",{staticClass:"q-mx-md",attrs:{filter:"",clearable:"","emit-value":"","map-options":"",multiple:"",color:"primary",label:e.$t("payment_list_filter_status"),options:e.statusOptions},model:{value:e.selectedStatuses,callback:function(t){e.selectedStatuses=t},expression:"selectedStatuses"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 row"},[r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-input",{staticClass:"q-mx-md",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("payment_list_filter_amountMin"),type:"number",debounce:"500"},model:{value:e.amountMin,callback:function(t){e.amountMin=e._n(t)},expression:"amountMin"}})],1),r("div",{staticClass:"col-xs-12 col-md-6"},[r("q-input",{staticClass:"q-mx-md",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("payment_list_filter_amountMax"),type:"number",debounce:"500"},model:{value:e.amountMax,callback:function(t){e.amountMax=e._n(t)},expression:"amountMax"}})],1)]),r("div",{staticClass:"col-xs-12 row justify-end q-pt-sm q-px-md"},[r("q-btn",{staticClass:"col-xs-12 col-sm-auto",attrs:{label:e.$t("action_create")},on:{click:e.createInvoice}})],1)])]),r("q-table",{attrs:{"row-key":"id",data:e.items,columns:e.columns,loading:e.loading,pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"loading",fn:function(){return[r("q-inner-loading",{attrs:{showing:"",color:"primary"}})]},proxy:!0},{key:"body-cell-companyName",fn:function(t){return r("q-td",{attrs:{props:t}},[t.row.company?r("router-link",{attrs:{to:{name:"individual-details",params:{companyId:t.row.company.id}}}},[e._v("\n            "+e._s(t.row.company.name)+"\n          ")]):e._e()],1)}},{key:"body-cell-id",fn:function(t){return r("q-td",{attrs:{props:t}},[r("span",[e._v("\n            "+e._s(t.row.id)+"\n          ")]),r("q-icon",{staticClass:"q-ml-sm cursor-pointer",attrs:{name:"file_copy",color:"primary",size:"sm"},on:{click:function(r){return e.copyInvoiceLink(t.row.paymentUrl)}}})],1)}},{key:"body-cell-action",fn:function(t){return r("q-td",{attrs:{props:t}},[r("div",{staticClass:"row"},[r("q-btn",{staticClass:"col-xs-12",attrs:{size:"sm",color:"primary"},on:{click:function(r){return e.editProjectInvoice(+t.row.id)}}},[e._v("\n            "+e._s(e.$t("project_invoice_action_edit"))+"\n          ")]),"pending"===t.row.paymentStatus?r("q-btn",{staticClass:"col-xs-12 q-mt-sm",attrs:{size:"sm",color:"negative"},on:{click:function(r){return e.decline(t.row.id)}}},[e._v("\n            "+e._s(e.$t("project_invoice_action_decline"))+"\n          ")]):e._e()],1)])}}])})],1),r("project-invoice-form")],1)},o=[],i=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("96cf"),r("c973")),a=r.n(i),s=r("9523"),c=r.n(s),l=r("c1df"),u=r.n(l),m=r("2f62"),d=r("e657"),p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-dialog",{attrs:{value:e.projectInvoiceFormIsVisible,maximized:e.$q.screen.lt.sm},on:{"before-hide":e.cancel}},[r("q-layout",{staticClass:"bg-white",attrs:{view:"hhh lpr fFf",container:""}},[r("q-page-container",[e.projectInvoiceFormIsVisible?r("q-page",{staticClass:"bg-white q-py-md",class:e.$q.screen.lt.sm?"q-px-md":"q-px-lg "},[r("div",{staticClass:"text-h5"},[e._v("\n          "+e._s(e.isCreation?e.$t("project_invoice_create_page_title"):e.$t("project_invoice_edit_page_title"))+"\n        ")]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 row"},[r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_name"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.name.$error,"error-message":e.getErrorMessage(e.$v.formModel.name,e.t)},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name","string"===typeof t?t.trim():t)},expression:"formModel.name"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_email"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.email.$error,"error-message":e.getErrorMessage(e.$v.formModel.email,e.t)},model:{value:e.formModel.email,callback:function(t){e.$set(e.formModel,"email","string"===typeof t?t.trim():t)},expression:"formModel.email"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_phone"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.phone.$error,"error-message":e.getErrorMessage(e.$v.formModel.phone,e.t)},model:{value:e.formModel.phone,callback:function(t){e.$set(e.formModel,"phone","string"===typeof t?t.trim():t)},expression:"formModel.phone"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_invoice_client_description"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.description.$error,"error-message":e.getErrorMessage(e.$v.formModel.description,e.t)},model:{value:e.formModel.description,callback:function(t){e.$set(e.formModel,"description","string"===typeof t?t.trim():t)},expression:"formModel.description"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_amount"),disable:!e.isCreation,suffix:e.userCurrency,"bottom-slots":"",autogrow:"",error:e.$v.formModel.amount.$error,"error-message":e.getErrorMessage(e.$v.formModel.amount,e.t)},model:{value:e.formModel.amount,callback:function(t){e.$set(e.formModel,"amount","string"===typeof t?t.trim():t)},expression:"formModel.amount"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_company_id"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.companyId.$error,"error-message":e.getErrorMessage(e.$v.formModel.companyId,e.t)},model:{value:e.formModel.companyId,callback:function(t){e.$set(e.formModel,"companyId","string"===typeof t?t.trim():t)},expression:"formModel.companyId"}})],1),r("div",{staticClass:"col-xs-12 q-px-xs"},[r("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:e.$t("field_comment"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.internalComment.$error,"error-message":e.getErrorMessage(e.$v.formModel.internalComment,e.t)},model:{value:e.formModel.internalComment,callback:function(t){e.$set(e.formModel,"internalComment","string"===typeof t?t.trim():t)},expression:"formModel.internalComment"}})],1)])])]):e._e()],1),r("q-footer",{staticClass:"bg-white row q-py-sm q-px-md"},[r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"order-last":"q-mr-sm",attrs:{rounded:"",label:e.$t("action_cancel"),color:"secondary",disable:e.loading,icon:"arrow_back"},on:{click:e.cancel}}),r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"q-mb-sm":"q-mr-sm",attrs:{rounded:"",label:e.$t(e.isCreation?"action_create":"action_save"),color:"primary",icon:e.isCreation?"add":"save",loading:e.loading},on:{click:e.saveChanges}})],1)],1)],1)},f=[],h=(r("7f7f"),r("1cb6")),v=r("b5ae"),g=r("5944"),b=r("aacf"),y=r("d59f");function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var j={name:"ProjectInvoiceForm",mixins:[g["a"]],components:{},data:function(){return{t:this.$t.bind(this),formModelKey:"projectInvoiceDetails",loading:!1,urls:b["a"]}},computed:_({},Object(m["c"])("projectInvoices",["projectInvoiceCreateError","projectInvoiceUpdateError","projectInvoiceDetails","projectInvoiceId","projectInvoiceFormIsVisible"]),{isCreation:function(){return!this.projectInvoiceId},isRu:function(){return"ru"===this.$q.lang.isoName},userCurrency:function(){return this.isRu?"RUB":"USD"}}),watch:{projectInvoiceFormIsVisible:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchProjectInvoiceDetails({variables:{id:+this.projectInvoiceId}});case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},methods:_({},Object(m["d"])("projectInvoices",["projectInvoiceHideForm","setSelectedId"]),{},Object(m["b"])("projectInvoices",["fetchProjectInvoiceDetails","createProjectInvoice","updateProjectInvoice"]),{getErrorMessage:y["a"],createNewProjectInvoice:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.name,n=t.phone,o=t.email,i=t.amount,a=t.internalComment,s=t.companyId,c=t.description,e.prev=1,e.next=4,this.createProjectInvoice({variables:{name:r,phone:n,email:o,amount:i,internalComment:a,description:c,currency:this.userCurrency,companyId:s||null}});case 4:this.projectInvoiceCreateError?this.$q.notify({type:"negative",message:this.projectInvoiceCreateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("project_invoice_form_success_created")}),h["a"].logEvent("project-invoices-page","create-project-invoice","",0,this.$router.currentRoute)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("project_invoice_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),editProjectInvoice:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.id,n=t.name,o=t.phone,i=t.email,a=t.internalComment,s=t.companyId,e.prev=1,e.next=4,this.updateProjectInvoice({variables:{id:r,name:n,phone:o,email:i,internalComment:a,companyId:s||null}});case 4:this.projectInvoiceUpdateError?this.$q.notify({type:"negative",message:this.projectInvoiceUpdateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("project_invoice_form_success_updated")}),h["a"].logEvent("project-invoices-page","edit-project-invoice","",0,this.$router.currentRoute)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("project_invoice_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),saveChanges:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.validateFormAndNotify()){e.next=2;break}return e.abrupt("return");case 2:if(this.loading=!0,!this.isCreation){e.next=8;break}return e.next=6,this.createNewProjectInvoice();case 6:e.next=10;break;case 8:return e.next=10,this.editProjectInvoice();case 10:this.loading=!1;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$v.$reset(),this.projectInvoiceHideForm()}}),validations:{formModel:{name:{maxLength:Object(v["maxLength"])(200)},description:{maxLength:Object(v["maxLength"])(200)},phone:{maxLength:Object(v["maxLength"])(20)},email:{required:v["required"],email:v["email"]},amount:{required:v["required"],numeric:v["numeric"]},companyId:{numeric:v["numeric"]},internalComment:{maxLength:Object(v["maxLength"])(1e3)}}}},w=j,$=r("42e1"),I=Object($["a"])(w,p,f,!1,null,null,null),q=I.exports,C=r("ee47"),M=r("5334");function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O={name:"projectInvoiceList",mixins:[C["a"]],components:{ProjectInvoiceForm:q},data:function(){return{loading:!1,pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:25,rowsNumber:0},columns:[{name:"id",label:this.$t("field_id"),field:"id",align:"left",sortable:!0},{name:"name",label:this.$t("field_name"),field:"name",align:"left",sortable:!1},{name:"phone",label:this.$t("field_phone"),field:"phone",align:"left",sortable:!1},{name:"amount",label:this.$t("field_amount"),field:"amount",align:"left",sortable:!0},{name:"paymentStatus",label:this.$t("field_status"),field:"paymentStatus",align:"left",sortable:!0},{name:"internalComment",label:this.$t("field_comment"),field:"internalComment",align:"left",sortable:!0},{name:"companyName",label:this.$t("field_company_name"),field:"company",align:"left",sortable:!1},{name:"createdAt",label:this.$t("field_created_at"),field:"createdAt",align:"left",sortable:!0,format:function(e){return u()(e).tz("Europe/Saratov").format("DD/MM/YYYY HH:mm:ss")}},{name:"expirationDate",label:this.$t("field_expiration_date"),field:"expirationDate",align:"left",sortable:!0,format:function(e){return u()(e).tz("Europe/Saratov").format("DD/MM/YYYY HH:mm:ss")}},{name:"action",label:this.$t("field_action"),field:"action",align:"left",sortable:!0}],searchTerm:"",namePhoneSearchTerm:"",selectedStatuses:[],statusOptions:[{label:this.$t("company_payment_status_succeeded"),value:"succeeded"},{label:this.$t("company_payment_status_pending"),value:"pending"},{label:this.$t("company_payment_status_canceled"),value:"canceled"}],amountMin:0,amountMax:1e4}},computed:P({},Object(m["c"])("projectInvoices",["projectInvoiceDeclineError"]),{},Object(m["c"])("projectInvoices",{items:"projectInvoicePagedListItems",totalCount:"projectInvoicePagedListCount",needReload:"projectInvoicePagedListNeedReload"})),watch:{searchTerm:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),namePhoneSearchTerm:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),selectedStatuses:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),amountMin:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),amountMax:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),needReload:function(e){e&&(this.projectInvoicePagedListNeedReload(!1),this.fetchGridData(this.pagination))}},mounted:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(this.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:P({},Object(m["b"])("projectInvoices",["fetchProjectInvoicePagedList","declineProjectInvoice"]),{},Object(m["d"])("projectInvoices",["projectInvoiceShowForm","projectInvoiceSetSelectedId","projectInvoicePagedListNeedReload"]),{createInvoice:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.projectInvoiceSetSelectedId(null),this.projectInvoiceShowForm();case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancelInvoice:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.cancelPendingProjectInvoice({variables:{id:1}});case 2:this.cancelPendingProjectInvoiceErrorCode&&this.$q.notify({type:"negative",message:this.$t(this.cancelPendingProjectInvoiceErrorCode)});case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchGridData:function(){var e=a()(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=t||this.pagination,r=P({searchTerm:this.searchTerm,namePhoneSearchTerm:this.namePhoneSearchTerm,paymentStatuses:this.selectedStatuses,amountMin:this.amountMin||0,amountMax:this.amountMax||0},Object(M["a"])(t)),e.next=4,this.fetchProjectInvoicePagedList({variables:r});case 4:Object(M["b"])(this.pagination,t,this.totalCount);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onRequest:function(){var e=a()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGridData(t.pagination);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),copyInvoiceLink:function(e){Object(d["a"])(e),this.$q.notify({type:"positive",message:this.$t("url_was_copied")})},editProjectInvoice:function(e){this.projectInvoiceSetSelectedId(e),this.projectInvoiceShowForm()},decline:function(){var e=a()(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$q.dialog({title:this.$t("project_invoice_action_decline_confirmation"),ok:this.$t("Yes"),cancel:this.$t("No")}).onOk(a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.declineProjectInvoice({variables:{id:t}});case 2:if(!r.projectInvoiceDeclineError){e.next=6;break}r.$q.notify({type:"negative",message:r.$t(r.projectInvoiceDeclineError)}),e.next=8;break;case 6:return e.next=8,r.fetchGridData();case 8:case"end":return e.stop()}}),e)}))));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()})},R=O,S=Object($["a"])(R,n,o,!1,null,null,null);t["default"]=S.exports}}]);