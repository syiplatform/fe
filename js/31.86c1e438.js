(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[31],{"79d7":function(e,t,r){"use strict";var a=r("dc9c"),n=r.n(a);n.a},"945d":function(e,t,r){},b635:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("div",{staticClass:"q-px-sm"},[r("div",{staticClass:"text-h4 text-primary q-py-sm"},[e._v(e._s(e.$t("our_partners")))]),r("div",{staticClass:"text-subtitle2 text-grey-14 q-pb-md"},[e._v("\n      "+e._s(e.$t("partners_offer_description_text"))+".\n    ")])]),r("entity-list",{attrs:{list:e.partnerOfferList.items,namespace:"partnerOffer",isPossibleToOpenDetailsPage:!1,isPossibleToOpenDetails:!1,isPossibleToConfirm:!1,isPossibleToDelete:!0,readOnly:!e.currentUserIsSuperAdmin},scopedSlots:e._u([{key:"media",fn:function(t){var a=t.entity;return[a.image&&a.image.file?r("lazy-image",{staticClass:"col",attrs:{src:""+e.urls.imagePath+a.image.file.name}}):e._e()]}},{key:"title",fn:function(t){var a=t.entity;return[r("div",{staticClass:"text-h6 text-weight-light"},[e._v(e._s(a.title))])]}},{key:"main",fn:function(t){var a=t.entity;return[r("div",{staticClass:"text-weight-light",domProps:{innerHTML:e._s(a.description)}})]}},{key:"footer",fn:function(t){var a=t.entity;return[a.link?r("q-btn",{staticClass:"text-secondary nm-shadow",attrs:{rounded:"",type:"a",target:"_blank",href:a.link},on:{click:function(t){return e.logClick(a.name)}}},[e._v("\n        "+e._s(a.linkText)+"\n      ")]):e._e()]}}])}),r("partner-offer-form")],1)},n=[],i=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("96cf"),r("c973")),s=r.n(i),o=r("9523"),c=r.n(o),l=r("2f62"),f=r("ee47"),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"row"},[r("div",{staticClass:"row col-xs-12 items-stretch"},e._l(e.list,(function(t){return r("div",{key:t.id,staticClass:"row col-xs-12 col-sm-6 col-lg-4 q-px-sm q-mb-md items-stretch"},[r("q-card",{staticClass:"column col-xs-12 shadow-glow rounded bg-grey-2",attrs:{color:t.color}},[r("q-card-section",{staticClass:"no-padding"},[r("div",{staticClass:"relative-position"},[e._t("media",null,{entity:t}),!e.readOnly&&t.id?r("entity-menu",{staticClass:"q-ma-sm absolute-top-right",attrs:{namespace:e.namespace,id:t.id,isPossibleToOpenDetailsPage:"company"===e.namespace||"location"===e.namespace,isPossibleToDelete:!t.isOfficialHoliday}}):e._e()],2)]),r("q-card-section",[e._t("title",null,{entity:t})],2),r("q-card-section",{staticClass:"q-pt-xs"},[e._t("main",null,{entity:t})],2),r("q-card-actions",{staticClass:"card-footer row justify-center items-end q-pa-md"},[e._t("footer",null,{entity:t})],2)],1)],1)})),0),e.readOnly?e._e():r("div",{staticClass:"row col-xs-12 col-sm-auto q-px-sm q-mb-sm items-stretch"},[r("q-card",{staticClass:"col-xs-12 row q-pa-none justify-stretch text-primary "},[r("q-item",{staticClass:"col-xs-12 col-sm-auto add-btn q-pa-none row items-stretch",attrs:{link:""}},[r("add-button",{attrs:{namespace:e.namespace,size:"big"}})],1)],1)],1)])},u=[],d=r("698a"),p=r("b22d"),g={name:"ImageCards",components:{EntityMenu:d["a"],AddButton:p["a"]},props:{list:{type:Array,required:!0},namespace:{type:String,required:!0},readOnly:{type:Boolean,required:!1,default:!0}}},h=g,b=(r("d7ac"),r("42e1")),v=Object(b["a"])(h,m,u,!1,null,null,null),O=v.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-dialog",{attrs:{value:e.isPartnerOfferFormVisible,maximized:e.$q.screen.lt.sm},on:{"before-hide":e.cancel}},[r("q-layout",{staticClass:"bg-white",attrs:{view:"hhh lpr fFf",container:""}},[r("q-page-container",[e.isPartnerOfferFormVisible?r("q-page",{staticClass:"bg-white",class:e.$q.screen.lt.sm?"q-px-md":"q-px-lg "},[r("div",{staticClass:"q-py-md"},[r("div",{staticClass:"text-h5"},[e._v("\n                "+e._s(e.isCreation?e.$t("partner_offer_create_page_title"):e.formModel.title)+"\n            ")])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_name"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.title.$error,"error-message":e.getErrorMessage(e.$v.formModel.name,e.t)},model:{value:e.formModel.name,callback:function(t){e.$set(e.formModel,"name","string"===typeof t?t.trim():t)},expression:"formModel.name"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_title"),"bottom-slots":"",autogrow:"",error:e.$v.formModel.title.$error,"error-message":e.getErrorMessage(e.$v.formModel.title,e.t)},model:{value:e.formModel.title,callback:function(t){e.$set(e.formModel,"title","string"===typeof t?t.trim():t)},expression:"formModel.title"}})],1),r("q-field",{staticClass:"row col-xs-12 q-px-xs",attrs:{borderless:"","stack-label":"",label:e.$t("field_description"),color:"dark"}},[r("custom-editor",{staticClass:"col-xs-12",attrs:{model:e.formModel.description,onChange:function(t){return e.formModel.description=t}}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_partner_offer_link_text"),"bottom-slots":"",error:e.$v.formModel.link.$error,"error-message":e.getErrorMessage(e.$v.formModel.linkText,e.t)},model:{value:e.formModel.linkText,callback:function(t){e.$set(e.formModel,"linkText","string"===typeof t?t.trim():t)},expression:"formModel.linkText"}})],1),r("div",{staticClass:"col-xs-12 col-md-6 q-px-xs"},[r("q-input",{attrs:{label:e.$t("field_partner_offer_link"),"bottom-slots":"",error:e.$v.formModel.link.$error,"error-message":e.getErrorMessage(e.$v.formModel.link,e.t)},model:{value:e.formModel.link,callback:function(t){e.$set(e.formModel,"link","string"===typeof t?t.trim():t)},expression:"formModel.link"}})],1),r("div",{staticClass:"row col-xs-12 q-px-xs q-mt-md justify-center"},[r("image-cropper",{attrs:{namespace:"partnerOffer",initialData:e.formModel,initialImageSrc:e.formModel.image?""+e.urls.imagePath+e.formModel.image.file.name:"",width:400,height:300,imageCatalogueContainer:".q-dialog .absolute-full > .scroll",remove:e.removeImage}})],1)],1)]):e._e()],1),r("q-footer",{staticClass:"bg-white row q-py-sm q-px-md"},[r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"order-last":"q-mr-sm",attrs:{rounded:"",label:e.$t("action_cancel"),color:"secondary",disable:e.loading,icon:"arrow_back"},on:{click:e.cancel}}),r("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:e.$q.screen.lt.sm?"q-mb-sm":"q-mr-sm",attrs:{rounded:"",label:e.$t(e.isCreation?"action_create":"action_save"),color:"primary",icon:e.isCreation?"add":"save",loading:e.loading},on:{click:e.saveChanges}})],1)],1)],1)},y=[],_=(r("b54a"),r("7f7f"),r("b5ae")),q=r("5944"),w=r("aacf"),k=r("d59f"),C=r("8d86"),P=r("7288"),$=r("376c"),M=r("310e"),j=r.n(M);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D={name:"PartnerOfferForm",mixins:[q["a"]],components:{imageCropper:P["a"],draggable:j.a,CustomEditor:$["a"]},data:function(){return{t:this.$t.bind(this),formModelKey:"partnerOfferDetails",loading:!1,urls:w["a"]}},computed:I({},Object(l["c"])("partnerOffer",["partnerOfferCreateError","partnerOfferUpdateError","partnerOfferDetails","partnerOfferId","isPartnerOfferFormVisible"]),{isCreation:function(){return!this.partnerOfferId}}),watch:{isPartnerOfferFormVisible:function(){var e=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchPartnerOfferDetails({variables:{id:+this.partnerOfferId}});case 2:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},methods:I({},Object(l["d"])("partnerOffer",["hideForm","setSelectedId"]),{},Object(l["b"])("partnerOffer",["fetchPartnerOfferDetails","createPartnerOffer","updatePartnerOffer"]),{},Object(l["b"])("image",["uploadImage"]),{getErrorMessage:k["a"],createNewPartnerOffer:function(){var e=s()(regeneratorRuntime.mark((function e(){var t,r,a,n,i,s,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.name,a=t.title,n=t.description,i=t.link,s=t.linkText,o=t.imageId,c=t.orderNumber,e.prev=1,e.next=4,this.createPartnerOffer({variables:{input:{name:r,title:a,description:n,link:i,linkText:s,imageId:o,orderNumber:c}}});case 4:this.partnerOfferCreateError?this.$q.notify({type:"negative",message:this.partnerOfferCreateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("partner_offer_form_success_created")})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("partner_offer_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),editPartnerOffer:function(){var e=s()(regeneratorRuntime.mark((function e(){var t,r,a,n,i,s,o,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.id,a=t.name,n=t.title,i=t.description,s=t.link,o=t.linkText,c=t.imageId,l=t.orderNumber,e.prev=1,e.next=4,this.updatePartnerOffer({variables:{id:r,input:{name:a,title:n,description:i,link:s,linkText:o,imageId:c,orderNumber:l}}});case 4:this.partnerOfferUpdateError?this.$q.notify({type:"negative",message:this.partnerOfferUpdateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("partner_offer_form_success_updated")})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$q.notify({type:"negative",message:this.$t("partner_offer_form_errors_can_not_save")});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}(),saveChanges:function(){var e=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.validateFormAndNotify()){e.next=2;break}return e.abrupt("return");case 2:if(this.loading=!0,!this.formModel.tempImage||!this.formModel.tempImage.img){e.next=7;break}return e.next=6,this.uploadConvertedImage(this.formModel.tempImage);case 6:this.formModel.image=e.sent;case 7:if(this.formModel.imageId=this.formModel.image&&this.formModel.image.id,!this.isCreation){e.next=13;break}return e.next=11,this.createNewPartnerOffer();case 11:e.next=15;break;case 13:return e.next=15,this.editPartnerOffer();case 15:this.loading=!1;case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$v.$reset(),this.hideForm()},removeImage:function(e){e.image=null},uploadConvertedImage:function(){var e=s()(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,Object(C["a"])(t);case 3:return r=e.sent,e.next=6,this.uploadImage({file:r,type:"image"});case 6:return a=e.sent,a.crossOrigin="anonymous",e.abrupt("return",{id:a.id,url:"".concat(w["a"].imagePath).concat(a.file.name)});case 9:return e.abrupt("return","");case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),validations:{formModel:{name:{required:_["required"],maxLength:Object(_["maxLength"])(200)},title:{required:_["required"],maxLength:Object(_["maxLength"])(200)},description:{required:_["required"]},link:{required:_["required"],url:_["url"],maxLength:Object(_["maxLength"])(450)},linkText:{required:_["required"],maxLength:Object(_["maxLength"])(200)}}}},T=D,L=(r("79d7"),Object(b["a"])(T,x,y,!1,null,"1413af99",null)),R=L.exports,S=r("1cb6");function N(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?N(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var A={name:"PartnerOfferList",mixins:[f["a"]],components:{EntityList:O,PartnerOfferForm:R},data:function(){return{formModelKey:"partnerOfferDetails",searchTerm:"",initialSlide:0,urls:w["a"],pagination:{orderBy:"orderNumber",order:"ASC",pageNumber:1,pageSize:50,rowsNumber:0}}},meta:function(){return{title:this.$t("company_partners_page_title")}},computed:F({},Object(l["c"])("partnerOffer",["partnerOfferList"]),{},Object(l["c"])("auth",["currentUserIsSuperAdmin"])),mounted:function(){var e=s()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.trackUserAction({actionName:"openPartnersPage"});case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:F({},Object(l["b"])("auth",["trackUserAction"]),{},Object(l["b"])("partnerOffer",["fetchPartnerOfferList"]),{fetch:function(){var e=s()(regeneratorRuntime.mark((function e(){var t,r,a,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.pagination,r=t.pageNumber,a=t.pageSize,n=t.orderBy,i=t.order,e.next=3,this.fetchPartnerOfferList({variables:{pageNumber:r,pageSize:a,orderBy:n,order:i}});case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),logClick:function(e){S["a"].logEvent("partner-offers","click",e,0,this.$router.currentRoute)}})},U=A,z=Object(b["a"])(U,a,n,!1,null,null,null);t["default"]=z.exports},d7ac:function(e,t,r){"use strict";var a=r("945d"),n=r.n(a);n.a},dc9c:function(e,t,r){}}]);