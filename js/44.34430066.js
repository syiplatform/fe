(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[44],{4117:function(t,e,n){"use strict";var r=n("d257"),a=n.n(r);a.a},"77d0":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-page",{staticClass:"row items-stretch",attrs:{padding:""}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.paymentList&&t.paymentList.items&&t.paymentList.items.length,expression:"paymentList && paymentList.items && paymentList.items.length"}],staticClass:"col-xs-12",class:t.$q.screen.lt.sm?"q-pa-sm":"q-py-lg q-px-xs"},[n("q-list",{staticClass:"row"},t._l(t.paymentList.items,(function(t){return n("pending-payment-item",{key:t.id,staticClass:"col-xs-12 tariff-row row",attrs:{payment:t}})})),1)],1),n("div",{staticClass:"col-xs-12",class:t.$q.screen.lt.sm?"q-pa-sm":"q-py-lg q-px-xs"},[n("q-list",{staticClass:"row"},t._l(t.tariffHistoryList.items,(function(t){return n("q-item",{key:t.id,staticClass:"col-xs-12 tariff-row"},[n("tariff-history-item",{attrs:{"tariff-history":t}})],1)})),1)],1)])},a=[],i=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("96cf"),n("c973")),s=n.n(i),c=n("9523"),o=n.n(c),y=(n("c5f6"),n("2f62")),u=n("c98f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-item-section",[n("div",{staticClass:"text-subtitle2"},[t._v("\n    "+t._s(t.$t(t.tariffHistory.tariff))+"\n  ")]),n("div",{staticClass:"text-caption q-mb-sm"},[t._v("\n    "+t._s(t._f("dateTimeText")(t.tariffHistory.createdAt,t.currentUserTimezone))+"\n  ")]),t.isTrial&&!t.isConverted?n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"info",size:"16px"}}),t._v("\n    "+t._s(t.$t("tariff_history_trial_activated"))+"\n  ")],1):t.isTrial&&t.isConverted?n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"autorenew",size:"16px"}}),t._v("\n    "+t._s(t.$t("tariff_history_change_trial"))+"\n  ")],1):t.hasPayment||t.hasFeedback||!t.isPaidTariff||t.hasPackagePaymentId?t.hasPackagePaymentId?n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"info",size:"16px"}}),t._v("\n    "+t._s(t.$t("tariff_history_tariff_package_payment"))+"\n  ")],1):t.hasFeedback?n("div",{staticClass:"text-caption text-primary"},[n("div",[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"feedback",size:"16px"}}),t._v("\n      "+t._s(t.$t("tariff_history_feedback"))+"\n    ")],1),n("div",[t._v("\n      "+t._s(t.$t("tariff_history_feedback_days"))+": "+t._s(t.feedbackPayDays)+"\n    ")])]):t.hasPayment?n("div",{staticClass:"text-caption text-primary"},[n("div",[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"monetization_on",size:"16px"}}),t._v("\n      "+t._s(t.$t("tariff_history_tariff_paid"))+"\n    ")],1),n("div",[t._v("\n      "+t._s(t.$t("tariff_history_sum"))+": "+t._s(t.amount)+" "+t._s(t.currencyLabel)+"\n    ")]),n("div",[t._v("\n      "+t._s(t.$t("tariff_history_paid_days"))+": "+t._s(t.paymentPayDays)+"\n    ")]),t.hasPromocode?n("div",[t._v("\n      "+t._s(t.$t("field_promocode"))+": "+t._s(t.promocode)+"\n    ")]):t._e()]):n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"info",size:"16px"}}),t._v("\n    "+t._s(t.$t("tariff_history_free_activated"))+"\n  ")],1):n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"autorenew",size:"16px"}}),t._v("\n    "+t._s(t.$t("tariff_history_transfer_tariff"))+"\n  ")],1),t.tariffHistory.tariffExpirationDate?n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"timer_off",size:"16px"}}),t._v("\n    "+t._s(t._f("dateTimeText")(t.tariffHistory.tariffExpirationDate,t.currentUserTimezone))+"\n  ")],1):t._e()])},p=[];function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"CompanyTariffHistoryItem",data:function(){return{tariffs:u["h"]}},props:{tariffHistory:{type:Object}},computed:l({},Object(y["c"])("auth",["currentUserTimezone"]),{payment:function(){return this.tariffHistory.payment},feedback:function(){return this.tariffHistory.feedback},hasPayment:function(){return!!this.payment},hasFeedback:function(){return!!this.feedback},promocode:function(){return this.payment&&this.payment.promocode},hasPromocode:function(){return!!this.promocode},feedbackPayDays:function(){return this.feedback&&this.feedback.payDays},hasFeedbackPayDays:function(){return!!this.feedbackPayDays},paymentPayDays:function(){return this.payment&&this.payment.payDays},hasPaymentPayDays:function(){return!!this.paymentPayDays},amount:function(){return this.payment&&(this.payment.originalAmount||this.payment.amount)},hasAmount:function(){return!!this.amount},currency:function(){return this.payment&&(this.payment.originalCurrency||this.payment.currency)},hasCurrency:function(){return!!this.currency},currencyLabel:function(){return this.hasCurrency?this.$t("".concat(this.currency,"_3_letters_abbr")):this.$t("RUB_3_letters_abbr")},isPaidTariff:function(){return this.tariffHistory.tariff!==u["h"].Free1},isTrial:function(){return this.tariffHistory.isTrial},isConverted:function(){return this.tariffHistory.isConverted},hasPackagePaymentId:function(){return this.tariffHistory.packagePaymentId}})},d=h,_=n("42e1"),b=Object(_["a"])(d,f,p,!1,null,null,null),v=b.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-item",[n("q-item-section",[n("div",{staticClass:"text-subtitle2"},[t._v("\n      "+t._s(t.$t(t.payment.tariff))+"\n    ")]),n("div",{staticClass:"text-caption q-mb-sm"},[t._v("\n      "+t._s(t._f("dateTimeText")(t.payment.createdAt,t.currentUserTimezone))+"\n    ")]),n("div",{staticClass:"text-caption text-primary"},[n("q-icon",{staticClass:"q-mr-xs",attrs:{name:"info",size:"16px"}}),t._v("\n      "+t._s(t.$t("tariff_history_pending_payment"))+"\n    ")],1),n("div",{staticClass:"text-caption text-primary"},[n("div",[t._v("\n        "+t._s(t.$t("tariff_history_sum"))+": "+t._s(t.amount)+" "+t._s(t.currencyLabel)+"\n      ")]),n("div",[t._v("\n        "+t._s(t.$t("tariff_history_paid_days"))+": "+t._s(t.payDays)+"\n      ")]),t.hasBonus?n("div",{staticClass:"text-info"},[t._v("\n        "+t._s(t.$t("tariff_history_bonus_amount_blocked"))+": "+t._s(t.bonusAmount)+" "+t._s(t.$t("bonus_symbol"))+"\n      ")]):t._e()])]),n("q-item-section",{attrs:{thumbnail:""}},[n("div",{staticClass:"q-pb-sm"},[t.hasPaymentUrl?n("q-btn",{staticClass:"col-xs-12",attrs:{color:"secondary",rounded:""},on:{click:t.payAgain}},[t._v("\n          "+t._s(t.$t("tariff_history_pay_pending_payment"))+"\n      ")]):t._e()],1),n("div",{staticClass:"q-pb-sm"},[n("q-btn",{staticClass:"col-xs-12",attrs:{color:"accent",rounded:""},on:{click:t.cancelPayment}},[t._v("\n          "+t._s(t.$t("tariff_history_cancel_pending_payment"))+"\n      ")])],1)])],1)},x=[];function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var C={name:"PendingPaymentItem",data:function(){return{}},props:{payment:{type:Object}},computed:O({},Object(y["c"])("auth",["currentUserId","currentUserTimezone"]),{},Object(y["c"])("company",["cancelPendingPaymentErrorCode"]),{payDays:function(){return this.payment&&this.payment.payDays},hasPayDays:function(){return!!this.payDays},amount:function(){return this.payment&&(this.payment.originalAmount||this.payment.amount)},hasAmount:function(){return!!this.amount},hasBonus:function(){return!!this.payment.bonus},bonusAmount:function(){return this.hasBonus&&-1*this.payment.bonus.amount},currency:function(){return this.payment&&(this.payment.originalCurrency||this.payment.currency)},hasCurrency:function(){return!!this.currency},currencyLabel:function(){return this.hasCurrency?this.$t("".concat(this.currency,"_3_letters_abbr")):this.$t("RUB_3_letters_abbr")},hasPaymentUrl:function(){return!!this.paymentUrl},paymentUrl:function(){return this.payment&&this.payment.paymentUrl}}),methods:O({},Object(y["b"])("company",["fetchPaymentList","cancelPendingPayment"]),{},Object(y["b"])("bonus",["fetchCurrentBonusAmount"]),{cancelPayment:function(){var t=s()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.cancelPendingPayment({variables:{id:this.payment.id}});case 2:if(!this.cancelPendingPaymentErrorCode){t.next=6;break}this.$q.notify({type:"negative",message:this.$t(this.cancelPendingPaymentErrorCode)}),t.next=8;break;case 6:return t.next=8,this.fetchCurrentBonusAmount({variables:{userId:this.currentUserId}});case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),payAgain:function(){window.location=this.paymentUrl}})},j=C,w=Object(_["a"])(j,P,x,!1,null,null,null),q=w.exports;function k(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?k(Object(n),!0).forEach((function(e){o()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var $={name:"CompanyTariffHistory",components:{tariffHistoryItem:v,pendingPaymentItem:q},meta:function(){return{title:this.pageTitle}},data:function(){return{tariffs:u["h"]}},props:{companyId:{type:[Number,String]}},computed:D({},Object(y["c"])("company",["paymentList","tariffHistoryList","companyDetails"]),{},Object(y["c"])("auth",["currentUserTimezone"]),{pageTitle:function(){var t="";return this.companyDetails&&this.companyDetails.urlPath&&(t=this.companyDetails.urlPath),this.$t("company_tariff_history_page_title",{project:t})}}),mounted:function(){var t=s()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchTariffHistoryList({variables:{companyId:this.companyId,pageNumber:1,pageSize:1e3,orderBy:"createdAt",order:"DESC"}});case 2:return t.next=4,this.fetchPaymentList({variables:{companyId:this.companyId,paymentStatuses:["pending"],pageNumber:1,pageSize:1e3,orderBy:"createdAt",order:"DESC"}});case 4:this.trackUserAction({actionName:"openTariffsHistoryPage"});case 5:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:D({},Object(y["b"])("auth",["trackUserAction"]),{},Object(y["b"])("company",["fetchPaymentList","fetchTariffHistoryList"]))},T=$,H=(n("4117"),Object(_["a"])(T,r,a,!1,null,null,null));e["default"]=H.exports},d257:function(t,e,n){}}]);