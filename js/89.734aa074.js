(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[89],{4536:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{attrs:{padding:""}},[r("q-banner",{staticClass:"bg-info text-white col-xs-12 text-caption border-radius q-mb-md",attrs:{appear:""},scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"help",color:"white"}})]},proxy:!0}])},[r("div",{staticClass:"row items-center"},[r("div",{staticClass:"col-xs-12 col-lg text-center"},[e._v("\n        "+e._s(e.$t("read_more_about_products"))+"\n      ")]),r("q-btn",{staticClass:"col-xs-12 col-lg-auto",class:e.$q.screen.lt.lg?"q-mt-sm":"",attrs:{rounded:"",size:"md",outline:"",label:e.$t("open_instruction"),type:"a",target:"_blank",href:e.urls.blog.manageProductsList}})],1)]),r("q-card",{staticClass:"border-radius q-mb-md bg-white"},[r("div",{staticClass:"row q-pa-md q-mb-xs"},[r("q-input",{staticClass:"col q-mr-lg",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",debounce:500,placeholder:e.$t("product_search_placeholder"),color:"secondary",icon:"search"},model:{value:e.searchTerm,callback:function(t){e.searchTerm=t},expression:"searchTerm"}}),r("div",{staticClass:"col-xs-auto"},[r("add-button",{attrs:{namespace:"product",showFormMutationName:"productShowForm",setSelectedIdMutationName:"productSetSelectedId"}})],1)],1)]),r("div",{class:e.$q.screen.lt.sm?"q-py-sm":""},[r("image-tiles",{ref:"imageTiles",attrs:{namespace:"product",pagedListName:"productAdmin",hasInfo:!1,hasMain:!0,deleteRecordActionName:"deleteProduct",deleteErrorGetterName:"productDeleteError",confirmErrorGetterName:"productConfirmError",confirmErrorActionName:"productConfirmError",showFormMutationName:"productShowForm",setSelectedIdMutationName:"productSetSelectedId",fetch:e.fetch},scopedSlots:e._u([{key:"title",fn:function(t){var i=t.entity;return[i.link?r("a",{staticClass:"ellipsis-3-lines",attrs:{target:"_blank",href:i.link}},[e._v("\n            "+e._s(i.title)+"\n          ")]):r("span",{staticClass:"ellipsis-3-lines"},[e._v(e._s(i.title))])]}},{key:"image",fn:function(t){var i=t.entity;return i.images?[i.images&&i.images.length?r("q-card-section",{staticClass:"col-xs-12 row no-padding"},[i.images&&i.images.length>1?r("vue-slick-carousel",{key:"carousel",staticClass:"full-width",attrs:{arrows:!1,dots:!0,autoplay:!0}},e._l(i.images,(function(t,i){return r("lazy-image",{key:t.image.id,staticClass:"col-xs-12",attrs:{index:i,src:""+e.urls.imagePath+t.image.file.name}})})),1):e._e(),i.images&&1===i.images.length?r("lazy-image",{attrs:{src:""+e.urls.imagePath+i.images[0].image.file.name}}):e._e()],1):e._e(),i.images&&i.images.length?e._e():r("q-separator",{staticClass:"row col-xs-12 q-mb-sm self-start"})]:void 0}},{key:"main",fn:function(t){var i=t.entity;return[r("price",{staticClass:"row col-xs-12 text-h6 justify-center q-pt-sm",attrs:{product:i}}),r("div",{staticClass:"row col-xs-12 justify-center q-pt-sm"},[i.categories.length?r("div",e._l(i.categories,(function(t){return r("q-badge",{key:t.id,staticClass:"q-mr-sm",attrs:{outline:"",color:"primary"}},[e._v("\n                  "+e._s(t.title)+"\n                ")])})),1):r("div",[r("q-badge",{attrs:{outline:"","multi-line":"",color:"secondary"}},[e._v("\n                  "+e._s(e.$t("product_no_category"))+"\n                ")])],1)]),r("div",{staticClass:"row col-xs-12 justify-center items-start q-pt-sm"},[r("q-badge",{staticClass:"q-mr-sm q-mb-sm",attrs:{color:"accent"}},[r("q-tooltip",{attrs:{"content-class":"text-body2"}},[r("p",[e._v(e._s(e.$t("product_analytics_opened_details")))])]),r("q-icon",{attrs:{name:"touch_app",size:"14px"}}),e._v(" "+e._s(i.viewCount)+"\n              ")],1),r("q-badge",{staticClass:"q-mr-sm q-mb-sm",attrs:{color:"primary"}},[r("q-tooltip",{attrs:{"content-class":"text-body2"}},[r("p",[e._v(e._s(e.$t("product_analytics_start_purchase")))])]),r("q-icon",{attrs:{name:"add_shopping_cart",size:"14px"}}),e._v(" "+e._s(i.purchaseStartCount)+"\n              ")],1),r("q-badge",{staticClass:"q-mr-sm q-mb-sm",attrs:{color:"secondary"}},[r("q-tooltip",{attrs:{"content-class":"text-body2"}},[r("p",[e._v(e._s(e.$t("product_analytics_purchase_count")))])]),r("q-icon",{attrs:{name:"payment",size:"14px"}}),e._v(" "+e._s(i.purchaseFinishCount)+"\n              ")],1),i.price&&i.currency?r("q-badge",{staticClass:"q-mr-sm",attrs:{color:"green"}},[r("q-tooltip",{attrs:{"content-class":"text-body2"}},[r("p",[e._v(e._s(e.$t("product_analytics_purchase_sum")))])]),r("q-icon",{attrs:{name:"attach_money",size:"14px"}}),e._v(e._s(i.purchaseFinishAmount)+"Â \n                "+e._s(e.$t(e.currencyShortLabels[i.currency]))+"\n              ")],1):e._e()],1)]}}],null,!0)}),e.companyId?r("company-product-form",{attrs:{companyId:e.companyId}}):e._e()],1)],1)},o=[],s=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("06db"),r("456d"),r("96cf"),r("c973")),a=r.n(s),n=r("9523"),c=r.n(n),l=(r("c5f6"),r("11ec")),d=r("2f62"),m=r("ee47"),u=r("241b"),p=function(){var e=this,t=this,r=t.$createElement,i=t._self._c||r;return i("q-dialog",{attrs:{persistent:"",value:t.productFormIsVisible&&!t.loading,maximized:t.$q.screen.lt.sm}},[i("q-layout",{staticClass:"bg-white",class:{"light-dimmed":t.loading||t.saving},attrs:{view:"hhh lpr fFf",container:""}},[i("q-page-container",[i("q-page",{staticClass:"bg-white q-py-md",class:{"q-px-md":t.$q.screen.lt.sm,"q-px-lg":!t.$q.screen.lt.sm}},[i("div",{staticClass:"text-h5"},[t._v("\n                "+t._s(t.isCreation?t.$t("product_create_page_title"):t.formModel.title)+"\n        ")]),i("div",{staticClass:"row"},[i("q-tabs",{staticClass:"text-grey col-xs-12",attrs:{"active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("q-tab",{attrs:{name:"description",label:t.$t("field_description"),alert:t.$v.formModel.$anyError?"red":"transparent"}}),i("q-tab",{attrs:{name:"action",label:t.$t("action_after_payment")}})],1),i("q-separator",{staticClass:"col-xs-12"}),i("q-tab-panels",{staticClass:"row col-xs-12",attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[i("q-tab-panel",{staticClass:"col-xs-12 row no-padding",attrs:{name:"description"}},[i("div",{staticClass:"col-xs-12 col-md-6 q-pt-sm"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_name"),"bottom-slots":"",autogrow:"",error:t.$v.formModel.title.$error,"error-message":t.getErrorMessage(t.$v.formModel.title,t.t)},model:{value:t.formModel.title,callback:function(e){t.$set(t.formModel,"title","string"===typeof e?e.trim():e)},expression:"formModel.title"}})],1),i("div",{staticClass:"col-xs-12 col-md-6 q-pt-sm"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_product_link"),"bottom-slots":"",error:t.$v.formModel.titleLink.$error,"error-message":t.getErrorMessage(t.$v.formModel.titleLink,t.t)},model:{value:t.formModel.titleLink,callback:function(e){t.$set(t.formModel,"titleLink","string"===typeof e?e.trim():e)},expression:"formModel.titleLink"}})],1),i("q-field",{staticClass:"row col-xs-12",attrs:{borderless:"","stack-label":"",label:t.$t("field_description"),color:"dark"}},[i("custom-editor",{staticClass:"col-xs-12",attrs:{model:t.formModel.description,onChange:function(t){return e.formModel.description=t}}})],1),i("div",{staticClass:"row col-xs-12 q-py-xs"},[i("div",{staticClass:"row col-xs-6 col-sm-3"},[i("q-toggle",{staticClass:"col-xs-12",attrs:{disable:t.formModel.isNoPrice,label:t.$t("field_product_price_range"),color:"secondary"},model:{value:t.formModel.isPriceRange,callback:function(e){t.$set(t.formModel,"isPriceRange",e)},expression:"formModel.isPriceRange"}})],1),i("div",{staticClass:"row col-xs-6 col-sm-3"},[i("q-toggle",{staticClass:"col-xs-12",attrs:{label:t.$t("field_product_no_price"),color:"secondary"},model:{value:t.formModel.isNoPrice,callback:function(e){t.$set(t.formModel,"isNoPrice",e)},expression:"formModel.isNoPrice"}})],1),t.formModel.isPriceRange||t.formModel.isNoPrice?i("q-banner",{staticClass:"col-xs-12 col-sm-6 q-pa-md cursor-pointer\n                  bg-warning text-white border-radius",scopedSlots:t._u([{key:"avatar",fn:function(){return[i("q-icon",{attrs:{name:"warning",color:"white"}})]},proxy:!0}],null,!1,894313219)},[t._v(t._s(t.$t("product_no_price_warning"))+"\n              ")]):t._e()],1),t.formModel.isNoPrice?t._e():i("div",{staticClass:"row col-xs-12"},[t.formModel.isPriceRange?i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_price_min"),type:"number","bottom-slots":"",error:t.$v.formModel.priceMin.$error,"error-message":t.getErrorMessage(t.$v.formModel.priceMin,t.t)},model:{value:t.formModel.priceMin,callback:function(e){t.$set(t.formModel,"priceMin","string"===typeof e?e.trim():e)},expression:"formModel.priceMin"}})],1):t._e(),t.formModel.isPriceRange?i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_price_max"),type:"number","bottom-slots":"",error:t.$v.formModel.priceMax.$error,"error-message":t.getErrorMessage(t.$v.formModel.priceMax,t.t)},model:{value:t.formModel.priceMax,callback:function(e){t.$set(t.formModel,"priceMax","string"===typeof e?e.trim():e)},expression:"formModel.priceMax"}})],1):t._e(),t.formModel.isPriceRange?t._e():i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_price"),type:"number","bottom-slots":"",error:t.$v.formModel.price.$error,"error-message":t.getErrorMessage(t.$v.formModel.price,t.t)},model:{value:t.formModel.price,callback:function(e){t.$set(t.formModel,"price","string"===typeof e?e.trim():e)},expression:"formModel.price"}})],1),t.formModel.isPriceRange?t._e():i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("field_discounted_price"),type:"number","bottom-slots":"",error:t.$v.formModel.priceDiscount.$error,"error-message":t.getErrorMessage(t.$v.formModel.priceDiscount,t.t)},model:{value:t.formModel.priceDiscount,callback:function(e){t.$set(t.formModel,"priceDiscount","string"===typeof e?e.trim():e)},expression:"formModel.priceDiscount"}})],1),i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("select-input",{attrs:{label:t.$t("field_currency"),options:t.currencyCodeOptions,model:t.formModel.currency,disable:t.companyDetails.isCartActive,error:t.$v.formModel.currency.$error,"error-message":t.getErrorMessage(t.$v.formModel.currency,t.t),onInput:function(e){return t.formModel.currency=e}}})],1),i("div",{staticClass:"col-xs-6 col-md-3 q-px-xs"},[i("select-input",{attrs:{label:t.$t("field_price_unit"),hint:t.$t("field_price_unit_hint"),options:t.priceUnitOptions,model:t.formModel.priceUnit,error:t.$v.formModel.priceUnit.$error,"error-message":t.getErrorMessage(t.$v.formModel.priceUnit,t.t),onInput:function(e){return t.formModel.priceUnit=e}}})],1)]),i("div",{staticClass:"col-xs-12 col-md-6"},[i("select-input",{attrs:{label:t.$t("field_product_category"),hint:t.productCategoryPagedListItems.length?t.$t("field_product_category_hint"):t.$t("field_product_category_empty_hint"),options:t.productCategoryPagedListItems,multiple:"","option-label":"title",model:t.formModel.categories,onInput:function(e){return t.formModel.categories=e}}})],1),i("div",{staticClass:"col-xs-12 q-mt-md"},[i("div",{staticClass:"text-grey-14 text-caption"},[t._v("\n                "+t._s(t.$t("landing_element_carousel_format_help"))+" 400x400px\n              ")]),t.images?i("q-list",{attrs:{"no-border":"",separator:""}},[i("draggable",{attrs:{list:t.images,"ghost-class":"ghost",handle:".handle-element"}},t._l(t.images,(function(e,r){return i("q-expansion-item",{key:e.uid,staticClass:"no-padding rounded q-mb-sm",class:{"bg-grey-3":r%2==0},attrs:{"default-opened":0===r,value:t.currentItem===r,group:"images","header-class":"q-pl-md rounded"},on:{"before-show":function(){t.currentItem=r}}},[i("template",{slot:"header"},[i("div",{staticClass:"text-primary row col-xs-auto"},[i("q-icon",{staticClass:"col-xs-auto handle-element q-px-xs q-mr-sm\n                          border-radius cursor-pointer drag-indicator",attrs:{name:"drag_indicator"}}),i("div",{staticClass:"text-primary col row items-center"},[t._v("\n                        "+t._s(t.$t("image_text"))+" "+t._s(r+1)+"\n                      ")])],1),i("q-btn",{staticClass:"absolute-top-right q-mt-sm q-mr-sm clear",attrs:{round:"",size:"sm",icon:"clear"},on:{click:function(e){return e.stopPropagation(),t.remove(r)}}})],1),i("div",{staticClass:"row col-xs-12 justify-center"},[i("image-cropper",{attrs:{isVisible:t.currentItem===r,namespace:"product",initialData:e,initialImageSrc:e.image?""+t.urls.imagePath+e.image:"",width:400,height:400,ratio:1,imageCatalogueContainer:".q-dialog .absolute-full > .scroll",remove:t.removeImage}})],1)],2)})),1)],1):t._e(),i("q-btn",{staticClass:"full-width q-my-sm",attrs:{rounded:"",icon:"add",label:t.$t("landing_element_carousel_btn_add")},on:{click:t.addImage}})],1)],1),i("q-tab-panel",{staticClass:"col-xs-12 row no-padding",attrs:{name:"action"}},[i("q-input",{staticClass:"col-xs-12 q-px-xs q-pt-sm",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("product_form_secret_link"),hint:t.$t("product_form_secret_link_helper"),"bottom-slots":"",error:t.$v.formModel.secretLink.$error,"error-message":t.getErrorMessage(t.$v.formModel.secretLink,t.t)},model:{value:t.formModel.secretLink,callback:function(e){t.$set(t.formModel,"secretLink","string"===typeof e?e.trim():e)},expression:"formModel.secretLink"}}),i("q-field",{attrs:{borderless:"","stack-label":"",hint:t.$t("product_form_send_email_helper")}},[i("q-toggle",{attrs:{label:t.$t("product_form_send_email"),color:"primary"},model:{value:t.formModel.needSendEmail,callback:function(e){t.$set(t.formModel,"needSendEmail",e)},expression:"formModel.needSendEmail"}})],1),i("q-input",{staticClass:"col-xs-12 q-px-xs",attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("product_form_email_subject"),"bottom-slots":""},model:{value:t.formModel.emailSubject,callback:function(e){t.$set(t.formModel,"emailSubject","string"===typeof e?e.trim():e)},expression:"formModel.emailSubject"}}),i("q-field",{staticClass:"row col-xs-12 q-px-xs",attrs:{borderless:"","stack-label":"",label:t.$t("product_form_email"),color:"dark"}},[i("custom-editor",{staticClass:"col-xs-12",attrs:{model:t.formModel.emailBody,onChange:function(e){return t.formModel.emailBody=e},enableHTML:!0}})],1)],1)],1)],1)])],1),i("q-footer",{staticClass:"bg-white row q-py-sm q-px-md"},[i("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:t.$q.screen.lt.sm?"order-last":"q-mr-sm",attrs:{rounded:"",label:t.$t("action_cancel"),color:"secondary",icon:"arrow_back"},on:{click:t.cancel}}),i("q-btn",{staticClass:"col-xs-12 col-sm-auto",class:t.$q.screen.lt.sm?"q-mb-sm":"q-mr-sm",attrs:{rounded:"",label:t.$t(t.isCreation?"action_create":"action_save"),color:"primary",icon:t.isCreation?"add":"save"},on:{click:t.saveChanges}})],1)],1),t.loading||t.saving?i("q-spinner",{staticClass:"absolute-center",attrs:{size:35,color:"info"}}):t._e()],1)},g=[],f=(r("7f7f"),r("1cb6")),h=r("b5ae"),b=r("5944"),y=r("aacf"),_=r("d59f"),x=r("8d86"),v=r("7066"),M=r("ad76"),q=r("7288"),$=r("376c"),C=r("310e"),w=r.n(C);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}M["a"].splice(0,0,{value:null,label:""});var I={name:"CompanyProductForm",mixins:[b["a"]],components:{imageCropper:q["a"],draggable:w.a,CustomEditor:$["a"]},props:{companyId:{type:[Number,String],required:!0}},data:function(){var e=this,t=M["a"].map((function(t){return{label:e.$t(t.label),value:t.value}}));return{t:this.$t.bind(this),formModelKey:"productDetails",images:[],loading:!1,saving:!1,urls:y["a"],currencyCodeOptions:v["a"],priceUnitOptions:t,tab:"description",currentItem:0}},computed:P({},Object(d["c"])("product",["productCreateError","productUpdateError","productDetails","productId","productFormIsVisible","productCategoryPagedListItems"]),{},Object(d["c"])("company",["companyDetails"]),{isCreation:function(){return!this.productId},selectedCategories:function(){return this.formModel.map((function(e){return{label:e.title,value:e.id}}))}}),watch:{productFormIsVisible:function(){var e=a()(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return this.loading=!0,e.next=4,this.fetchFullProductDetails({variables:{id:+this.productId}});case 4:return this.loading=!1,e.next=7,this.fetchProductCategoryPagedList({variables:{companyId:+this.companyId,pageNumber:1,pageSize:1e3}});case 7:this.companyDetails&&this.companyDetails.isCartActive&&(this.formModel.currency=this.companyDetails.currency),this.images=this.formModel.images&&this.formModel.images.length&&this.formModel.images.map((function(e){return{id:e.image&&e.image.id||"",image:e.image&&e.image.file&&e.image.file.name||"",tempImage:null}}))||[];case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},methods:P({},Object(d["d"])("product",["productDetailsReset","productHideForm","setSelectedId"]),{},Object(d["b"])("product",["fetchFullProductDetails","fetchProductCategoryPagedList","createProduct","updateProduct"]),{},Object(d["b"])("image",["uploadImage"]),{getErrorMessage:_["a"],createNewProduct:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,i,o,s,a,n,c,l,d,m,u,p,g,h,b,y,_;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.title,i=t.description,o=t.isPriceRange,s=t.priceUnit,a=t.currency,n=t.imageIds,c=t.titleLink,l=t.categories,d=t.secretLink,m=t.needSendEmail,u=t.isNoPrice,p=t.emailBody,g=u||o||!this.formModel.price&&0!==this.formModel.price&&"0"!==this.formModel.price?null:+this.formModel.price,h=u||!o||!this.formModel.priceMin&&0!==this.formModel.priceMin&&"0"!==this.formModel.priceMin?null:+this.formModel.priceMin,b=u||!o||!this.formModel.priceMax&&0!==this.formModel.priceMax&&"0"!==this.formModel.priceMax?null:+this.formModel.priceMax,y=u||o||!this.formModel.priceDiscount&&0!==this.formModel.priceDiscount&&"0"!==this.formModel.priceDiscount?null:+this.formModel.priceDiscount,_=this.formModel.emailSubject?this.formModel.emailSubject:r,e.prev=6,e.next=9,this.createProduct({variables:{input:{title:r,description:i,price:g,priceDiscount:y,priceMin:h,priceMax:b,isPriceRange:o,priceUnit:s,currency:a,imageIds:n,titleLink:c,categoryIds:l.map((function(e){return e.id})),secretLink:d,needSendEmail:m,isNoPrice:u,emailBody:p,emailSubject:_,companyId:+this.companyId}}});case 9:this.productCreateError?this.$q.notify({type:"negative",message:this.productCreateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("product_form_success_created")}),f["a"].logEvent("my-products-page","create-product",this.companyId,0,this.$router.currentRoute)),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](6),this.$q.notify({type:"negative",message:this.$t("product_form_errors_can_not_save")});case 15:case"end":return e.stop()}}),e,this,[[6,12]])})));function t(){return e.apply(this,arguments)}return t}(),editProduct:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,i,o,s,a,n,c,l,d,m,u,p,g,h,b,y,_,x;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.formModel,r=t.id,i=t.title,o=t.description,s=t.isPriceRange,a=t.priceUnit,n=t.currency,c=t.imageIds,l=t.titleLink,d=t.categories,m=t.secretLink,u=t.needSendEmail,p=t.isNoPrice,g=t.emailBody,h=p||s||!this.formModel.price&&0!==this.formModel.price&&"0"!==this.formModel.price?null:+this.formModel.price,b=p||!s||!this.formModel.priceMin&&0!==this.formModel.priceMin&&"0"!==this.formModel.priceMin?null:+this.formModel.priceMin,y=p||!s||!this.formModel.priceMax&&0!==this.formModel.priceMax&&"0"!==this.formModel.priceMax?null:+this.formModel.priceMax,_=p||s||!this.formModel.priceDiscount&&0!==this.formModel.priceDiscount&&"0"!==this.formModel.priceDiscount?null:+this.formModel.priceDiscount,x=this.formModel.emailSubject?this.formModel.emailSubject:i,e.prev=6,e.next=9,this.updateProduct({variables:{id:r,input:{title:i,description:o,price:h,priceMin:b,priceMax:y,isPriceRange:s,priceDiscount:_,priceUnit:a,currency:n,imageIds:c,titleLink:l,categoryIds:d.map((function(e){return e.id})),secretLink:m,needSendEmail:u,isNoPrice:p,emailBody:g,emailSubject:x}}});case 9:this.productUpdateError?this.$q.notify({type:"negative",message:this.productUpdateError}):(this.cancel(),this.$q.notify({type:"positive",message:this.$t("product_form_success_updated")}),f["a"].logEvent("my-products-page","edit-product",this.companyId,0,this.$router.currentRoute)),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](6),this.$q.notify({type:"negative",message:this.$t("product_form_errors_can_not_save")});case 15:case"end":return e.stop()}}),e,this,[[6,12]])})));function t(){return e.apply(this,arguments)}return t}(),saveChanges:function(){var e=a()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.validateFormAndNotify()){e.next=2;break}return e.abrupt("return");case 2:if(this.saving=!0,!this.images||!this.images.some((function(e){return e.tempImage&&e.tempImage.img}))){e.next=6;break}return e.next=6,this.getCroppaImages();case 6:if(this.formModel.imageIds=this.images.filter((function(e){return e.id})).map((function(e){return e.id})),!this.isCreation){e.next=12;break}return e.next=10,this.createNewProduct();case 10:e.next=14;break;case 12:return e.next=14,this.editProduct();case 14:this.saving=!1;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$v.$reset(),this.productHideForm(),this.productDetailsReset()},remove:function(e){this.images.splice(e,1)},removeImage:function(e){e.image="",e.id=null},addImage:function(){this.images.push({id:"",image:"",tempImage:null}),this.currentItem=this.images.length-1},getCroppaImages:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[],r=0;case 2:if(!(r<this.images.length)){e.next=14;break}if(!this.images[r].tempImage||!this.images[r].tempImage.img){e.next=10;break}return e.next=6,this.uploadConvertedImage(this.images[r].tempImage);case 6:i=e.sent,t.push(i),e.next=11;break;case 10:this.images[r].image&&t.push(this.images[r]);case 11:r+=1,e.next=2;break;case 14:this.images=t;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),uploadConvertedImage:function(){var e=a()(regeneratorRuntime.mark((function e(t){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.next=3,Object(x["a"])(t);case 3:return r=e.sent,e.next=6,this.uploadImage({file:r,type:"image",needW100:!0,needW300:!0});case 6:return i=e.sent,i.crossOrigin="anonymous",e.abrupt("return",{id:i.id,url:"".concat(y["a"].imagePath).concat(i.file.name)});case 9:return e.abrupt("return","");case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}),validations:function(){var e={formModel:{title:{required:h["required"],maxLength:Object(h["maxLength"])(200)},description:{},price:{numeric:h["numeric"]},priceMin:{numeric:h["numeric"]},priceMax:{numeric:h["numeric"]},priceDiscount:{numeric:h["numeric"]},priceUnit:{},currency:{},titleLink:{url:h["url"],maxLength:Object(h["maxLength"])(450)},secretLink:{url:h["url"],maxLength:Object(h["maxLength"])(450)}}};return this.formModel.isNoPrice||(this.formModel.isPriceRange?this.formModel.priceMin||this.formModel.priceMax||(e.formModel.priceMin.required=h["required"],e.formModel.priceMax.required=h["required"]):e.formModel.price.required=h["required"],e.formModel.currency.required=h["required"]),e}},O=I,j=r("42e1"),D=Object(j["a"])(O,p,g,!1,null,"1bef5fca",null),S=D.exports,L=r("b22d"),E=r("c4e4");function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var U={name:"CompanyProducts",mixins:[m["a"]],components:{ImageTiles:u["a"],CompanyProductForm:S,AddButton:L["a"],Price:E["a"]},props:{companyId:[Number,String],required:!0},meta:function(){return{title:this.pageTitle}},data:function(){return{searchTerm:"",initialSlide:0,urls:y["a"],priceUnitShortLabels:M["b"],currencyShortLabels:v["c"]}},computed:N({},Object(d["c"])("product",{pagination:"productAdminPagedListPagination"}),{},Object(d["c"])("company",["companyDetails"]),{pageTitle:function(){var e="";return this.companyDetails&&this.companyDetails.urlPath&&(e=this.companyDetails.urlPath),this.$t("company_products_page_title",{project:e})}}),mounted:function(){this.trackUserAction({actionName:"openProductsPage"})},destroyed:function(){this.resetPagination()},watch:{searchTerm:function(){this.resetPagination();var e=!1;this.fetch(e),f["a"].logEvent("my-products-page","search-product",this.searchTerm,0,this.$router.currentRoute)}},methods:N({},Object(d["b"])("auth",["trackUserAction"]),{},Object(d["b"])("product",["fetchProductAdminPagedList"]),{},Object(d["b"])("company",["fetchIndividualCompanyDetails"]),{},Object(d["d"])("product",{paginationUpdate:"productAdminPagedListPaginationUpdate"}),{resetPagination:function(){var e=Object(l["a"])(!0,{},this.pagination);e.pageNumber=1,this.paginationUpdate(e)},fetch:function(){var e=a()(regeneratorRuntime.mark((function e(){var t,r,i,o,s,a,n=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],t||this.$refs.imageTiles&&this.$refs.imageTiles.reset(),r=this.pagination,i=r.pageNumber,o=r.pageSize,s=r.sortBy,a=r.descending,e.next=5,this.fetchProductAdminPagedList({variables:{companyId:+this.companyId,searchTerm:this.searchTerm,pageNumber:i,pageSize:o,sortBy:s,descending:a},needAppendItems:t});case 5:return e.next=7,this.fetchIndividualCompanyDetails({variables:{id:+this.companyId}});case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()})},F=U,A=Object(j["a"])(F,i,o,!1,null,null,null);t["default"]=A.exports}}]);