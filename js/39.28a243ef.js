(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[39],{bbf8:function(t,a,e){"use strict";var n=e("ee59"),s=e.n(n);s.a},e680:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"row items-start content-start text-grey-9",attrs:{padding:""}},[e("div",{staticClass:"row col-xs-12 text-h6"},[e("q-toggle",{attrs:{value:t.companyDetails.isAutoPaymentEnabled,"checked-icon":"check",color:"green",label:t.$t("autopayment_title"),"unchecked-icon":"clear","left-label":""},on:{input:t.toggleAutopayment}})],1),t.companyDetails.isAutoPaymentEnabled?e("div",{staticClass:"col-xs-12"},[e("q-icon",{attrs:{name:"help",color:"primary"}}),t._v("\n    "+t._s(t.$t("autopayment_hint",{date:t.autoDate,tariff:t.autoTariffText,duration:t.autoDuration}))+"\n  ")],1):t._e(),t.cardNumber&&t.cardExpirationDate?e("div",{staticClass:"row col-xs-12 q-mt-sm q-pa-md bg-primary-2 border-radius"},[e("div",{staticClass:"col-xs-12 q-pb-sm"},[t._v("\n      "+t._s(t.$t("autopayment_card_details_title"))+"\n    ")]),e("div",{staticClass:"row col-xs-12",class:{"justify-center":t.$q.screen.lt.sm}},[e("div",{staticClass:"credit-card bg-primary-3 shadow-glow rounded"},[e("div",{staticClass:"credit-card-last4"},[t._v("\n            "+t._s(t.cardNumber)+"\n        ")]),e("div",{staticClass:"credit-card-expiry"},[t._v("\n          "+t._s(t.cardExpirationDate)+"\n        ")])])])]):t._e(),e("div",{staticClass:"row col-xs-12 items-start q-mt-sm q-pa-md bg-secondary-2 border-radius"},[e("div",{staticClass:"col-xs-12 col-sm-3 col-lg-2 q-py-xs",class:{"q-pr-xs":!t.$q.screen.lt.sm}},[e("select-input",{attrs:{model:t.autoPaymentBonusUserId,options:t.users,label:t.$t("autopayment_bonus_user_id"),hint:t.$t("autopayment_user_hint"),readonly:!t.isEditMode,onInput:function(a){return t.autoPaymentBonusUserId=a}}})],1),e("div",{staticClass:"col-xs-12 col-sm-3 col-lg-2 q-py-xs",class:{"q-pl-xs":!t.$q.screen.lt.sm}},[e("q-input",{attrs:{rounded:"",standout:"bg-grey-2 text-grey-14",label:t.$t("autopayment_promocode_id"),hint:t.$t("autopayment_promocode_hint"),readonly:!t.isEditMode},model:{value:t.autoPaymentPromocode,callback:function(a){t.autoPaymentPromocode=a},expression:"autoPaymentPromocode"}})],1),t.isEditMode?t._e():e("div",{staticClass:"row col-xs-12 justify-end"},[e("q-btn",{staticClass:"text-secondary bg-secondary-2",attrs:{flat:"",size:"xs",disable:!t.companyDetails.isAutoPaymentEnabled||t.disableAutopaymentSettings},on:{click:t.edit}},[t._v("\n          "+t._s(t.$t("current_tariff_autopayment_settings"))+"\n      ")])],1),t.isEditMode?e("div",{staticClass:"row q-py-xs col-xs-12 col-sm-auto justify-center",class:{"q-px-sm":!t.$q.screen.lt.sm}},[e("q-btn",{staticClass:"col-xs-12 col-sm-auto bg-secondary text-white q-py-sm",attrs:{flat:""},on:{click:t.save}},[t._v("\n          "+t._s(t.$t("action_save"))+"\n      ")])],1):t._e(),t.isEditMode?e("div",{staticClass:"row q-py-xs col-xs-12 col-sm-auto justify-center"},[e("q-btn",{staticClass:"col-xs-12 col-sm-auto q-py-sm",attrs:{outline:"",color:"secondary"},on:{click:t.cancel}},[t._v("\n          "+t._s(t.$t("action_cancel"))+"\n      ")])],1):t._e()]),e("company-tariff-payment-form",{attrs:{companyId:t.companyId}})],1)},s=[],o=(e("8e6e"),e("8a81"),e("ac6a"),e("cadf"),e("06db"),e("456d"),e("96cf"),e("c973")),i=e.n(o),r=(e("4917"),e("9523")),c=e.n(r),m=(e("c5f6"),e("c98f")),u=e("2f62"),l=e("7f45"),y=e.n(l),p=e("418d"),d=e("1cb6");function f(t,a){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),e.push.apply(e,n)}return e}function h(t){for(var a=1;a<arguments.length;a++){var e=null!=arguments[a]?arguments[a]:{};a%2?f(Object(e),!0).forEach((function(a){c()(t,a,e[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):f(Object(e)).forEach((function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(e,a))}))}return t}var b={name:"CompanyAutopayment",components:{CompanyTariffPaymentForm:p["a"]},props:{companyId:{type:[Number,String],required:!1}},meta:function(){return{title:this.pageTitle}},data:function(){return{tariffs:m["h"],now:y()(),isEditMode:!1,autoPaymentBonusUserId:null,autoPaymentPromocode:null}},computed:h({},Object(u["c"])("company",["companyDetails"]),{},Object(u["c"])("companyUser",["companyUserList"]),{disableAutopaymentSettings:function(){return!this.companyDetails||this.companyDetails.isAutoPaymentEnabled&&!this.companyDetails.isAutoPaymentValid},pageTitle:function(){var t="";return this.companyDetails&&this.companyDetails.urlPath&&(t=this.companyDetails.urlPath),this.$t("company_my_tariff_page_title",{project:t})},autoTariff:function(){return this.companyDetails?this.companyDetails.autoPaymentTariffName:null},isCurrentTrial:function(){if(this.companyDetails){var t=y()(this.companyDetails.trialExpirationDate).diff(y()(),"days");return t>=0}return!1},autoTariffText:function(){return this.autoTariff?this.$t(this.autoTariff):""},cardNumber:function(){if(this.companyDetails&&this.companyDetails.autoPaymentCardPan){var t=this.companyDetails.autoPaymentCardPan.match(/(\d|\*){4}/g);return"".concat(t[0],"  ").concat(t[1],"  ").concat(t[2],"  ").concat(t[3])}return""},cardExpirationDate:function(){return this.companyDetails&&this.companyDetails.autoPaymentCardExpiration?y()(this.companyDetails.autoPaymentCardExpiration).format("MM/YY"):""},autoDate:function(){return this.companyDetails&&this.companyDetails.nextAutoPaymentDate?y()(this.companyDetails.nextAutoPaymentDate).format("DD.MM.YY"):""},autoDuration:function(){return this.companyDetails&&this.companyDetails.autoPaymentTariffDays?y.a.duration(this.companyDetails.autoPaymentTariffDays,"days").humanize():""},users:function(){return this.companyUserList&&this.companyUserList.map((function(t){return{value:t.user.id,label:t.user.username}}))}}),mounted:function(){var t=i()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.companyId){t.next=7;break}return t.next=3,this.fetchIndividualCompanyDetails({variables:{id:this.companyId,needPendingPayments:!0}});case 3:return t.next=5,this.fetchCompanyUserList({variables:{companyId:this.companyId}});case 5:this.companyDetails&&(this.autoPaymentBonusUserId=this.companyDetails.autoPaymentBonusUserId,this.autoPaymentPromocode=this.companyDetails.autoPaymentPromocode),this.trackUserAction({actionName:"openAutopaymentPage"});case 7:case"end":return t.stop()}}),t,this)})));function a(){return t.apply(this,arguments)}return a}(),methods:h({},Object(u["b"])("auth",["trackUserAction"]),{},Object(u["b"])("company",["fetchIndividualCompanyDetails","updateCompanyAutopaymentSettings"]),{},Object(u["b"])("companyUser",["fetchCompanyUserList"]),{},Object(u["d"])("company",["showCompanyTariffPaymentForm","setCompanyPaymentCreateData","setCompanyAutopaymentData"]),{toggleAutopayment:function(t){!t||this.companyDetails&&this.companyDetails.isAutoPaymentValid?(d["a"].logEvent("company-autopayment-page","switch-autopayment",t?"on":"off","",this.$router.currentRoute),this.updateCompanyAutopaymentSettings({variables:{id:this.companyId,isEnabled:t}})):(d["a"].logEvent("company-autopayment-page","switch-autopayment","on","",this.$router.currentRoute),this.setCompanyPaymentCreateData({companyId:this.companyId}),this.showCompanyTariffPaymentForm())},edit:function(){this.isEditMode=!0},save:function(){this.updateCompanyAutopaymentSettings({variables:{id:this.companyId,isEnabled:this.companyDetails.isAutoPaymentEnabled,bonusUserId:this.autoPaymentBonusUserId,promocode:this.autoPaymentPromocode}}),this.isEditMode=!1},cancel:function(){this.isEditMode=!1,this.companyDetails&&(this.autoPaymentBonusUserId=this.companyDetails.autoPaymentBonusUserId,this.autoPaymentPromocode=this.companyDetails.autoPaymentPromocode)}})},P=b,D=(e("bbf8"),e("42e1")),v=Object(D["a"])(P,n,s,!1,null,"2fc24a74",null);a["default"]=v.exports},ee59:function(t,a,e){}}]);