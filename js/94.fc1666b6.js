(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[94],{"6e4c":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"text-grey-14"},[t.contestPublicDetails?s("div",{staticClass:"row"},[s("div",{staticClass:"col-xs-12 text-secondary text-h5 text-center q-py-md relative-position"},[t._v("\n      "+t._s(t.contestPublicDetails.name)+"\n      "),s("q-badge",{staticClass:"q-pa-sm",attrs:{color:"warning",floating:"",transparent:""}},[t._v("\n        "+t._s(t.$t("contest_status_"+t.contestPublicDetails.status))+"\n      ")])],1),s("div",{staticClass:"col-xs-12 text-center",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[s("q-btn",{staticClass:"q-mb-md",attrs:{rounded:"",color:"deep-orange",size:"20px",label:"Участвовать"},on:{click:function(e){return t.scroll("#take")}}})],1),s("div",{staticClass:"col-xs-12 q-pa-md"},[t.contestPublicDetails.imagePath?s("q-img",{class:t.$q.screen.lt.sm?"q-mb-sm":"float-left q-mx-sm",attrs:{contain:"",width:t.$q.screen.lt.sm?"100%":"400px",position:"50% 0",src:""+t.urls.imagePath+t.contestPublicDetails.imagePath}}):t._e(),s("div",{staticClass:"inline text-justify",domProps:{innerHTML:t._s(t.contestPublicDetails.description)}})],1),s("div",{staticClass:"row col-xs-12 bg-primary-2",class:t.$q.screen.lt.sm?"q-pa-md":"q-py-md"},[s("div",{staticClass:"row col-xs-12 offset-sm-3 col-sm-3 q-my-md text-primary text-weight-bold\n        content-start"},[s("div",{staticClass:"col-xs-12 q-pb-md"},[t._v("\n          Дата начала: "+t._s(t._f("dateTimeText")(t.contestPublicDetails.startDate))+"\n        ")]),t.isStarted?s("div",{staticClass:"col-xs-12 q-pb-md"},[t._v("\n          До конца конкурса: "),s("q-no-ssr",[t._v(t._s(t._f("humanizeTimeInterval")(t.interval)))])],1):t._e(),t.isCompleted?s("div",{staticClass:"col-xs-12 q-pb-md"},[t._v("Конкурс завершен")]):t._e(),s("div",{staticClass:"col-xs-12 q-pb-md"},[t._v("\n          Всего будет победителей: "+t._s(t.contestPublicDetails.numberOfWinners)+"\n        ")])]),s("div",{staticClass:"col-xs-12 col-sm-3 q-my-md  text-primary text-weight-bold",attrs:{id:"take"}},[t.isFeedbackDataSource?s("div",[s("div",[t._v("\n            Для участия в конкурсе необходимо:\n            "),s("ol",[s("li",[t._v("\n                отправить отзыв и зарегистрировать его на странице\n                "),s("router-link",{staticClass:"row items-center no-underline text-secondary",attrs:{to:{name:"client-feedback"}}},[t._v("\n                  Мои отзывы\n                  "),s("q-icon",{attrs:{name:"double_arrow"}})],1)],1),s("li",[t._v('после модерации и подтверждения вашего отзыва нажать "Выбрать"')])])])]):t.isProjectDataSource?s("div",[t._v("\n            Для участия в конкурсе необходимо:\n            "),s("ul",[s("li",[t._v("Выбрать проекты мультиссылок,\n                которые будут участвовать в конкусе\n                (если у Вас их несколько)\n              ")])])]):t._e()])]),t.isAuthenticated?s("div",{staticClass:"row col-xs-12"},[t.isFeedbackDataSource?s("div",{staticClass:"row col-xs-12"},[t.isStarted?s("div",{staticClass:"row col-xs-12 justify-center bg-grey-2 q-pa-md"},[t.contestPublicDetails.isOnePerUser?s("div",[t.alreadyFeedbackParticipant?s("div",[t._v("\n              Вы уже участвуете! Вы можете подать только одну заявку\n            ")]):s("div",{staticClass:"q-py-md"},[s("q-btn",{attrs:{rounded:"",color:"deep-orange",size:"20px",label:"Участвовать"},on:{click:t.sendAnyFeedback}})],1)]):t.formatedFeedbackItems.length?s("div",{staticClass:"row col-xs-12 justify-center"},[s("div",{staticClass:"col-xs-12 text-center text-subtitle1 text-weight-bold"},[t._v("\n              Выберите Ваш зарегистрированный отзыв для участия в конкурсе:\n              "),t._l(t.formatedFeedbackItems,(function(e){return s("div",{key:e.id,staticClass:"q-py-sm"},[s("span",{staticClass:"text-primary"},[t._v(t._s(e.senderName))]),t._v("|\n                отзыв на "+t._s(t.feedbackPlatformTitle(e))+"\n                "),e.choosed?s("span",{staticClass:"text-green no-wrap"},[s("q-icon",{attrs:{name:"done",color:"green"}}),t._v(" ВЫБРАН\n                ")],1):t.canParticipate?s("q-btn",{staticClass:"q-ml-sm",attrs:{rounded:"",color:"deep-orange",label:"Выбрать"},on:{click:function(s){return t.sendFeedback(e.id)}}}):t._e()],1)}))],2)]):t._e()]):t._e(),t.isCompleted?s("div",{staticClass:"col-xs-12 q-my-md",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[t.winners&&t.winners.length?s("div",[s("div",{staticClass:"text-subtitle1 text-weight-bold"},[t._v("Победители ("+t._s(t.winners.length)+"):")]),t._l(t.winners,(function(e){return s("div",{key:e.id},[s("span",{staticClass:"text-primary"},[t._v(t._s(e.feedback.senderName))]),t._v(" |\n              отзыв на "+t._s(t.feedbackPlatformTitle(e.feedback))+"\n            ")])}))],2):s("div",[t._v("\n            Нет победителей\n          ")])]):t._e(),t.isStarted||t.isCompleted?s("div",{staticClass:"row col-xs-12",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[t.participantItems&&t.participantItems.length?s("div",{staticClass:"row col-xs-12"},[s("div",{staticClass:"col-xs-12 q-pb-xs q-px-xs text-subtitle1 text-weight-bold"},[t._v("\n              Участники ("+t._s(t.participantItems.length)+"):\n            ")]),t._l(t.participantItems,(function(e){return s("div",{key:e.id,staticClass:"col-xs-12 col-sm-6 col-lg-3 q-pa-xs"},[s("span",{staticClass:"text-primary"},[t._v("\n                "+t._s(e.feedback&&e.feedback.senderName)+"\n              ")]),t._v("|\n              отзыв на "+t._s(e.feedback&&t.feedbackPlatformTitle(e.feedback))+"\n            ")])}))],2):s("div",[t._v("\n            Нет участников\n            "),t.isStarted?s("div",[t._v("Стань первым!")]):t._e()])]):t._e()]):t._e(),t.isProjectDataSource?s("div",{staticClass:"row col-xs-12"},[t.isStarted?s("div",{staticClass:"row col-xs-12 justify-center bg-grey-2 q-pa-md"},[s("div",{staticClass:"row col-xs-12"},[s("div",{staticClass:"col-xs-12 text-subtitle1 text-weight-bold"},[t._v("Выберите проект:")]),t._l(t.formatedProjectItems,(function(e){return s("div",{key:e.id,staticClass:"row col-xs-12 col-sm-6 col-lg-3 q-px-lg q-py-sm items-center no-wrap"},[e.choosed?s("div",{staticClass:"col-xs-auto text-green no-wrap"},[s("q-icon",{attrs:{name:"done",color:"green"}}),t._v(" ВЫБРАН\n              ")],1):t.canParticipate?s("q-btn",{staticClass:"col-xs-auto q-ml-sm",attrs:{rounded:"",color:"deep-orange",label:"Выбрать"},on:{click:function(s){return t.sendProject(e.id)}}}):t._e(),s("div",{staticClass:"col q-pl-sm ellipsis"},[t._v(t._s(e.name))])],1)}))],2)]):t._e(),t.isCompleted?s("div",{staticClass:"col-xs-12",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[t.winners&&t.winners.length?s("div",[s("div",{staticClass:"text-subtitle1 text-weight-bold"},[t._v("Победители:")]),t._l(t.winners,(function(e){return s("div",{key:e.id},[t._v("\n              "+t._s(e.id)+"\n            ")])}))],2):s("div",[t._v("\n            Нет победителей\n          ")])]):t._e(),t.isStarted||t.isCompleted?s("div",{staticClass:"row col-xs-12",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[t.participantItems&&t.participantItems.length?s("div",{staticClass:"row col-xs-12"},[s("div",{staticClass:"col-xs-12 q-pb-xs q-px-xs text-subtitle1 text-weight-bold"},[t._v("\n              Участники ("+t._s(t.participantItems.length)+"):\n            ")]),t._l(t.participantItems,(function(e){return s("div",{key:e.id,staticClass:"col-xs-12 col-sm-6 col-lg-3 q-pa-xs"},[t.contestPublicDetails.needVoting?s("q-card",[s("q-card-section",{staticClass:"no-padding relative-positin"},[e&&e.companyUrlPath?s("iframe",{staticClass:"no-border",attrs:{src:e.companyUrlPath+"?ignoreLogPage=true",scrolling:"no",width:"100%",height:"600px"}}):t._e(),s("q-btn",{staticClass:"bg-transparent absolute-full",attrs:{flat:"",type:"a",target:"_blank",href:""+e.companyUrlPath}})],1),s("q-card-actions",[s("div",{staticClass:"col-xs-12 row justify-center"},[s("div",{staticClass:"col-xs-12 text-center text-subtitle1 ellipsis q-pb-xs"},[t._v("\n                      "+t._s(e.companyUrlPathName)+"\n                    ")]),s("q-btn",{directives:[{name:"show",rawName:"v-show",value:!t.isCurrentUserAlreadyVoted,expression:"!isCurrentUserAlreadyVoted"}],attrs:{label:"Голосовать",loading:t.votePending,rounded:"",color:"orange"},on:{click:function(s){return t.sendVote(e.id)}}})],1)]),s("q-badge",{attrs:{floating:""}},[t._v("ГОЛОСОВ: "+t._s(e.totalVoteAmount))])],1):s("div",{staticClass:"row col-xs-12 col-sm-6 col-lg-3 q-px-lg q-py-sm items-center no-wrap"},[s("q-btn",{staticClass:"col-xs-auto bg-transparent",attrs:{flat:"",type:"a",target:"_blank",href:""+e.companyUrlPath}},[s("div",{staticClass:"no-wrap ellipsis"},[t._v(t._s(e.companyUrlPathName))])])],1)],1)}))],2):s("div",[t._v("\n            Нет участников\n            "),t.isStarted?s("div",[t._v("Стань первым!")]):t._e()])]):t._e()]):t._e()]):s("div",{staticClass:"col-xs-12 text-center",class:t.$q.screen.lt.sm?"q-pa-sm":"q-pa-md"},[s("div",{staticClass:"q-py-sm text-deep-orange text-weight-bold"},[t._v("\n        Войдите или зарегистрируйтесь для участия в конкурсе\n      ")]),s("q-btn",{attrs:{color:"deep-orange",rounded:"",size:"lg",title:t.$t("login_login_title"),to:{name:"login-"+t.$q.lang.isoName}}},[s("div",{staticClass:"ellipsis"},[t._v(t._s(t.$t("login_login")))])])],1)]):t._e()])},a=[],i=(s("8e6e"),s("8a81"),s("ac6a"),s("cadf"),s("06db"),s("456d"),s("96cf"),s("c973")),r=s.n(i),c=(s("7514"),s("7f7f"),s("9523")),o=s.n(c),l=(s("c5f6"),s("c1df")),d=s.n(l),u=s("2f62"),p=s("ee47"),m=s("241b"),f=s("aacf"),b=s("4147"),h={pending:"pending",completed:"completed",declined:"declined"},v=s("6281"),g=s("0831"),x=s("7b4b");function P(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,n)}return s}function _(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?P(Object(s),!0).forEach((function(e){o()(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var C=g["a"].setScrollPosition,w={name:"PublicContestDetails",mixins:[p["a"]],components:{ImageTiles:m["a"]},props:{contestId:{type:[Number,String]}},meta:function(){return{title:this.pageTitle}},data:function(){return{urls:f["a"],intervalId:"",interval:this.date?d.a.duration(d()(this.date).utc().diff(d()().utc())):"",votePending:!1,platformDetails:x["b"]}},computed:_({},Object(u["c"])("auth",["currentUserId","isAuthenticated"]),{},Object(u["c"])("contest",["contestPublicDetails"]),{},Object(u["c"])("contest",{participantItems:"contestParticipantPagedListItems",currentUserContestVotesItems:"contestVotePagedListItems",participantNeedReload:"contestParticipantPagedListNeedReload"}),{},Object(u["c"])("feedback",{feedbackItems:"feedbackPagedListItems",projectItems:"userCompaniesPagedListItems"}),{pageTitle:function(){var t="";return this.contestPublicDetails&&this.contestPublicDetails.name&&(t=this.contestPublicDetails.name),this.$t("company_contests_details_page_title",{name:t})},isCurrentUserAlreadyVoted:function(){return this.currentUserContestVotesItems.length>0},unusedFeedbackItems:function(){var t=this;return this.feedbackItems.filter((function(e){var s=t.participantItems.find((function(t){return t.feedbackId===e.id}));return!s}))},usedFeedbackItems:function(){var t=this;return this.feedbackItems.filter((function(e){var s=t.participantItems.find((function(t){return t.feedbackId===e.id}));return s}))},formatedFeedbackItems:function(){var t=this;return this.feedbackItems.map((function(e){return _({},e,{choosed:t.participantItems.find((function(t){return t.feedbackId===e.id}))})}))},formatedProjectItems:function(){var t=this;return this.projectItems.map((function(e){return _({},e,{choosed:t.participantItems.find((function(t){return t.companyId===e.id}))})}))},alreadyFeedbackParticipant:function(){return this.hasFeedbacks&&this.usedFeedbackItems.length},hasFeedbacks:function(){return this.feedbackItems.length},allUserCompaniesOptions:function(){return this.userCompaniesPagedListItems.map((function(t){return{label:t.name,value:t.id}}))},winners:function(){return this.participantItems.filter((function(t){return t.isWinner}))},isFeedbackDataSource:function(){return this.contestPublicDetails.dataSource===b["a"].feedback},isProjectDataSource:function(){return this.contestPublicDetails.dataSource===b["a"].project},canParticipate:function(){var t;return this.isFeedbackDataSource?t=this.formatedFeedbackItems.some((function(t){return t.choosed})):this.isProjectDataSource&&(t=this.formatedProjectItems.some((function(t){return t.choosed}))),!this.contestPublicDetails.isOnePerUser||!t},contestStatus:function(){return this.contestPublicDetails?this.contestPublicDetails.status:null},isPending:function(){return!this.contestStatus||this.contestStatus===v["a"].pending},isStarted:function(){return!this.contestStatus||this.contestStatus===v["a"].started},isCompleted:function(){return!this.contestStatus||this.contestStatus===v["a"].completed}}),watch:{participantNeedReload:function(t){t&&(this.contestParticipantPagedListNeedReload(!1),this.fetchContestParticipantPagedList({variables:{contestId:+this.contestId,pageNumber:1,pageSize:1e3,orderBy:"totalVoteAmount"}}))}},mounted:function(){this.intervalId=setInterval(this.getLeftTime,1e3)},beforeDestroy:function(){this.intervalId&&clearInterval(this.intervalId)},methods:_({},Object(u["b"])("contest",["fetchContestPublicDetails","fetchContestParticipantPagedList","fetchContestVotePagedList","createContestParticipant","createContestVote"]),{},Object(u["b"])("feedback",["fetchFeedbackPagedList","fetchUserCompaniesPagedList"]),{},Object(u["d"])("contest",["contestParticipantPagedListNeedReload"]),{fetch:function(){var t=r()(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchContestPublicDetails({variables:{id:+this.contestId}});case 2:return this.contestPublicDetails&&this.contestPublicDetails.endDate&&(e=d()(this.contestPublicDetails.endDate).utc(),this.interval=d.a.duration(e.diff(d()().utc()))),t.next=5,this.fetchContestParticipantPagedList({variables:{contestId:+this.contestId,pageNumber:1,pageSize:1e3,orderBy:"totalVoteAmount"}});case 5:if(!this.currentUserId){t.next=8;break}return t.next=8,this.fetchContestVotePagedList({variables:{contestId:+this.contestId,userId:this.currentUserId,pageNumber:1,pageSize:1e3}});case 8:return t.next=10,this.loadUserFeedbacks();case 10:return t.next=12,this.loadUserProjects();case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadUserFeedbacks:function(){var t=r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isAuthenticated){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.fetchFeedbackPagedList({variables:{userId:this.currentUserId,statuses:[h.completed],pageNumber:1,pageSize:1e3}});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadUserProjects:function(){var t=r()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.isAuthenticated){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.fetchUserCompaniesPagedList({variables:{userId:this.currentUserId,pageNumber:1,pageSize:100}});case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),sendAnyFeedback:function(){var t=r()(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.unusedFeedbackItems.length){t.next=6;break}return e=this.unusedFeedbackItems[0].id,t.next=4,this.createContestParticipant({variables:{contestId:+this.contestId,feedbackId:e}});case 4:t.next=7;break;case 6:this.$q.notify({type:"negative",message:"У Вас нет ни одного отзыва"});case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),sendFeedback:function(){var t=r()(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.createContestParticipant({variables:{contestId:+this.contestId,feedbackId:e}});case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),sendProject:function(){var t=r()(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.createContestParticipant({variables:{contestId:+this.contestId,companyId:e}});case 2:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),sendVote:function(){var t=r()(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.votePending=!0,t.next=3,this.createContestVote({variables:{contestParticipantId:e}});case 3:return t.next=5,this.fetchContestParticipantPagedList({variables:{contestId:+this.contestId,pageNumber:1,pageSize:1e3,orderBy:"totalVoteAmount"}});case 5:if(!this.currentUserId){t.next=8;break}return t.next=8,this.fetchContestVotePagedList({variables:{contestId:+this.contestId,userId:this.currentUserId,pageNumber:1,pageSize:1e3}});case 8:this.votePending=!1;case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),scroll:function(t){var e=document.querySelector(t),s=e.getBoundingClientRect().top+window.pageYOffset,n=1e3;C(window,s,n)},getLeftTime:function(){this.isStarted&&!this.isCompleted&&this.interval&&this.interval.subtract&&(this.interval=this.interval.subtract(1,"second"))},feedbackPlatformTitle:function(t){var e=x["b"][t.feedbackPlatform];return e?this.$t(e.label):t.feedbackPlatform}})},I=w,k=s("42e1"),q=Object(k["a"])(I,n,a,!1,null,null,null);e["default"]=q.exports}}]);